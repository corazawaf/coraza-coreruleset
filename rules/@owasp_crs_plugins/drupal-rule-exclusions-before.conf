# ------------------------------------------------------------------------
# OWASP CRS Plugin
# Copyright (c) 2021-2024 CRS project. All rights reserved.
#
# The OWASP CRS plugins are distributed under
# Apache Software License (ASL) version 2
# Please see the enclosed LICENSE file for full details.
# ------------------------------------------------------------------------

SecRule TX:drupal-rule-exclusions-plugin_enabled "@eq 0" "id:9506099,phase:1,pass,nolog,ctl:ruleRemoveById=9506100-9506999"
SecRule REQUEST_FILENAME "@unconditionalMatch" \
    "id:9506100,\
    phase:1,\
    pass,\
    nolog,\
    ctl:ruleRemoveTargetById=942450;REQUEST_COOKIES_NAMES,\
    ctl:ruleRemoveTargetById=942450;REQUEST_COOKIES,\
    ver:'drupal-rule-exclusions-plugin/1.0.0'"
SecRule REQUEST_FILENAME "@endsWith /core/install.php" \
    "id:9506110,\
    phase:1,\
    pass,\
    nolog,\
    ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:account[pass][pass1],\
    ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:account[pass][pass2],\
    ver:'drupal-rule-exclusions-plugin/1.0.0'"
SecRule REQUEST_FILENAME "@endsWith /user/login" \
    "id:9506112,\
    phase:1,\
    pass,\
    t:none,\
    nolog,\
    ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:pass,\
    ver:'drupal-rule-exclusions-plugin/1.0.0'"
SecRule REQUEST_FILENAME "@endsWith /admin/people/create" \
    "id:9506114,\
    phase:1,\
    pass,\
    nolog,\
    ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:pass[pass1],\
    ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:pass[pass2],\
    ver:'drupal-rule-exclusions-plugin/1.0.0'"
SecRule REQUEST_FILENAME "@rx /user/[0-9]+/edit$" \
    "id:9506116,\
    phase:1,\
    pass,\
    nolog,\
    ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:current_pass,\
    ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:pass[pass1],\
    ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:pass[pass2],\
    ver:'drupal-rule-exclusions-plugin/1.0.0'"
SecRule REQUEST_FILENAME "@contains /admin/config/" \
    "id:9506122,\
    phase:1,\
    pass,\
    nolog,\
    ctl:ruleRemoveById=942430,\
    ver:'drupal-rule-exclusions-plugin/1.0.0'"
SecRule REQUEST_FILENAME "@endsWith /admin/config/people/accounts" \
    "id:9506124,\
    phase:1,\
    pass,\
    nolog,\
    ctl:ruleRemoveById=920271,\
    ctl:ruleRemoveById=942440,\
    ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:user_mail_cancel_confirm_body,\
    ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:user_mail_password_reset_body,\
    ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:user_mail_register_admin_created_body,\
    ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:user_mail_register_no_approval_required_body,\
    ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:user_mail_register_pending_approval_body,\
    ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:user_mail_status_activated_body,\
    ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:user_mail_status_blocked_body,\
    ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:user_mail_status_canceled_body,\
    ver:'drupal-rule-exclusions-plugin/1.0.0'"
SecRule REQUEST_FILENAME "@endsWith /admin/config/development/configuration/single/import" \
    "id:9506126,\
    phase:1,\
    pass,\
    nolog,\
    ctl:ruleRemoveById=920271,\
    ctl:ruleRemoveById=942440,\
    ver:'drupal-rule-exclusions-plugin/1.0.0'"
SecRule REQUEST_FILENAME "@endsWith /admin/config/development/maintenance" \
    "id:9506128,\
    phase:1,\
    pass,\
    nolog,\
    ctl:ruleRemoveById=942440,\
    ver:'drupal-rule-exclusions-plugin/1.0.0'"
SecRule REQUEST_FILENAME "@endsWith /contextual/render" \
    "id:9506140,\
    phase:1,\
    pass,\
    nolog,\
    ctl:ruleRemoveTargetById=942130;ARGS:ids[],\
    ver:'drupal-rule-exclusions-plugin/1.0.0'"
SecRule REQUEST_FILENAME "@unconditionalMatch" \
    "id:9506160,\
    phase:1,\
    pass,\
    nolog,\
    ctl:ruleRemoveTargetById=942440;ARGS:form_build_id,\
    ctl:ruleRemoveTargetById=942450;ARGS:form_token,\
    ctl:ruleRemoveTargetById=942450;ARGS:form_build_id,\
    ver:'drupal-rule-exclusions-plugin/1.0.0'"
SecRule REQUEST_FILENAME "@endsWith /admin/config/content/formats/manage/full_html" \
    "id:9506170,\
    phase:1,\
    pass,\
    nolog,\
    ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:editor[settings][toolbar][button_groups],\
    ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:filters[filter_html][settings][allowed_html],\
    ver:'drupal-rule-exclusions-plugin/1.0.0'"
SecRule REQUEST_FILENAME "@endsWith /node/add/article" \
    "id:9506200,\
    phase:1,\
    pass,\
    nolog,\
    ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:body[0][value],\
    ctl:ruleRemoveTargetById=942410;ARGS:uid[0][target_id],\
    ver:'drupal-rule-exclusions-plugin/1.0.0'"
SecRule REQUEST_FILENAME "@endsWith /node/add/page" \
    "id:9506202,\
    phase:1,\
    pass,\
    nolog,\
    ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:body[0][value],\
    ctl:ruleRemoveTargetById=942410;ARGS:uid[0][target_id],\
    ver:'drupal-rule-exclusions-plugin/1.0.0'"
SecRule REQUEST_FILENAME "@rx /node/[0-9]+/edit$" \
    "id:9506204,\
    phase:1,\
    pass,\
    nolog,\
    ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:body[0][value],\
    ctl:ruleRemoveTargetById=942410;ARGS:uid[0][target_id],\
    ctl:ruleRemoveTargetById=932110;ARGS:destination,\
    ver:'drupal-rule-exclusions-plugin/1.0.0'"
SecRule REQUEST_FILENAME "@endsWith /block/add" \
    "id:9506206,\
    phase:1,\
    pass,\
    nolog,\
    ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:body[0][value],\
    ver:'drupal-rule-exclusions-plugin/1.0.0'"
SecRule REQUEST_FILENAME "@endsWith /admin/structure/block/block-content/manage/basic" \
    "id:9506208,\
    phase:1,\
    pass,\
    nolog,\
    ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:description,\
    ver:'drupal-rule-exclusions-plugin/1.0.0'"
SecRule REQUEST_FILENAME "@rx /editor/filter_xss/(?:full|basic)_html$" \
    "id:9506210,\
    phase:1,\
    pass,\
    nolog,\
    ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:value,\
    ver:'drupal-rule-exclusions-plugin/1.0.0'"
SecRule REQUEST_FILENAME "@rx /user/[0-9]+/contact$" \
    "id:9506212,\
    phase:1,\
    pass,\
    nolog,\
    ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:message[0][value],\
    ver:'drupal-rule-exclusions-plugin/1.0.0'"
SecRule REQUEST_FILENAME "@endsWith /admin/config/development/maintenance" \
    "id:9506214,\
    phase:1,\
    pass,\
    nolog,\
    ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:maintenance_mode_message,\
    ver:'drupal-rule-exclusions-plugin/1.0.0'"
SecRule REQUEST_FILENAME "@endsWith /admin/config/services/rss-publishing" \
    "id:9506216,\
    phase:1,\
    pass,\
    nolog,\
    ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:feed_description,\
    ver:'drupal-rule-exclusions-plugin/1.0.0'"
