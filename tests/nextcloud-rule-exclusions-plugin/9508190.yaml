---
meta:
  author: "Esad Cetiner"
  description: |
    This test file contains legacy tests from a refactor. In the past,
    there were multiple (Way too many) rules that solely handled allowing
    the required request methods. This test is a compilation of old
    tests from rules that no longer exist.
rule_id: 9508190
tests:
  - test_id: 1
    desc: |
      Nextcloud Mail:
      Editing an email alias
    stages:
      - input:
          dest_addr: 127.0.0.1
          headers:
            Host: localhost
            User-Agent: OWASP CRS test agent
            Accept: text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5
            Content-Type: application/json
          port: 80
          method: PUT
          uri: /apps/mail/api/accounts/2/aliases/1
          data: |-
            {"alias":"test@example.com","aliasName":"test123","smimeCertificateId":null}
          version: HTTP/1.1
        output:
          log:
            no_expect_ids: [911100]
  - test_id: 2
    desc: |
      Nextcloud Mail:
      Deleting an email alias
    stages:
      - input:
          dest_addr: 127.0.0.1
          headers:
            Host: localhost
            User-Agent: OWASP CRS test agent
            Accept: text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5
          port: 80
          method: DELETE
          uri: /apps/mail/api/accounts/2/aliases/1
          version: HTTP/1.1
        output:
          log:
            no_expect_ids: [911100]
  - test_id: 3
    desc: |
      Nextcloud Mail:
      Editing a tag
    stages:
      - input:
          dest_addr: 127.0.0.1
          headers:
            Host: localhost
            User-Agent: OWASP CRS test agent
            Accept: text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5
            Content-Type: application/json
          port: 80
          method: PUT
          uri: /apps/mail/api/tags/6
          data: |-
            {"displayName":"test123","color":"#541873"}
          version: HTTP/1.1
        output:
          log:
            no_expect_ids: [911100]
  - test_id: 4
    desc: |
      Nextcloud Mail:
      Deleting a tag
    stages:
      - input:
          dest_addr: 127.0.0.1
          headers:
            Host: localhost
            User-Agent: OWASP CRS test agent
            Accept: text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5
          port: 80
          method: DELETE
          uri: /apps/mail/api/tags/1/delete/6
          version: HTTP/1.1
        output:
          log:
            no_expect_ids: [911100]
  - test_id: 5
    desc: |
      Nextcloud Mail:
      Signing out of a mailbox
    stages:
      - input:
          dest_addr: 127.0.0.1
          headers:
            Host: localhost
            User-Agent: OWASP CRS test agent
            Accept: text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5
          port: 80
          method: DELETE
          uri: /apps/mail/api/accounts/1
          version: HTTP/1.1
        output:
          log:
            no_expect_ids: [911100]
  - test_id: 6
    desc: |
      Nextcloud Mail:
      Adding internal addresses (.com)
    stages:
      - input:
          dest_addr: 127.0.0.1
          headers:
            Host: localhost
            User-Agent: OWASP CRS test agent
            Accept: text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5
          port: 80
          method: PUT
          uri: /apps/mail/api/internalAddress/test%40example.com?type=individual
          version: HTTP/1.1
        output:
          log:
            no_expect_ids: [911100]
  - test_id: 7
    desc: |
      Nextcloud Mail:
      Removing internal addresses (.com)
    stages:
      - input:
          dest_addr: 127.0.0.1
          headers:
            Host: localhost
            User-Agent: OWASP CRS test agent
            Accept: text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5
          port: 80
          method: DELETE
          uri: /apps/mail/api/internalAddress/test%40example.com?type=individual
          version: HTTP/1.1
        output:
          log:
            no_expect_ids: [911100]
  - test_id: 8
    desc: |
      Nextcloud Mail:
      Adding internal addresses (.inc)
    stages:
      - input:
          dest_addr: 127.0.0.1
          headers:
            Host: localhost
            User-Agent: OWASP CRS test agent
            Accept: text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5
          port: 80
          method: PUT
          uri: /apps/mail/api/internalAddress/test%40example.inc?type=individual
          version: HTTP/1.1
        output:
          log:
            no_expect_ids: [911100]
  - test_id: 9
    desc: |
      Nextcloud Mail:
      Removing internal addresses (.inc)
    stages:
      - input:
          dest_addr: 127.0.0.1
          headers:
            Host: localhost
            User-Agent: OWASP CRS test agent
            Accept: text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5
          port: 80
          method: DELETE
          uri: /apps/mail/api/internalAddress/test%40example.inc?type=individual
          version: HTTP/1.1
        output:
          log:
            no_expect_ids: [911100]
  - test_id: 10
    desc: |
      Nextcloud Mail:
      Adding a domain to the trusted senders list (.com)
    stages:
      - input:
          dest_addr: 127.0.0.1
          headers:
            Host: localhost
            User-Agent: OWASP CRS test agent
            Accept: text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5
          port: 80
          method: PUT
          uri: /apps/mail/api/trustedsenders/example.com?type=domain
          version: HTTP/1.1
        output:
          log:
            no_expect_ids: [911100]
  - test_id: 11
    desc: |
      Nextcloud Mail:
      Removing a domain from the trusted senders list (.com)
    stages:
      - input:
          dest_addr: 127.0.0.1
          headers:
            Host: localhost
            User-Agent: OWASP CRS test agent
            Accept: text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5
          port: 80
          method: DELETE
          uri: /apps/mail/api/trustedsenders/example.com?type=domain
          version: HTTP/1.1
        output:
          log:
            no_expect_ids: [911100]
  - test_id: 12
    desc: |
      Nextcloud Mail:
      Adding a domain to the trusted senders list (.inc)
    stages:
      - input:
          dest_addr: 127.0.0.1
          headers:
            Host: localhost
            User-Agent: OWASP CRS test agent
            Accept: text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5
          port: 80
          method: PUT
          uri: /apps/mail/api/trustedsenders/example.inc?type=domain
          version: HTTP/1.1
        output:
          log:
            no_expect_ids: [911100]
  - test_id: 13
    desc: |
      Nextcloud Mail:
      Removing a domain from the trusted senders list (.inc)
    stages:
      - input:
          dest_addr: 127.0.0.1
          headers:
            Host: localhost
            User-Agent: OWASP CRS test agent
            Accept: text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5
          port: 80
          method: DELETE
          uri: /apps/mail/api/trustedsenders/example.inc?type=domain
          version: HTTP/1.1
        output:
          log:
            no_expect_ids: [911100]
  - test_id: 14
    desc: |
      Nextcloud Mail:
      Adding a tag to an email
    stages:
      - input:
          dest_addr: 127.0.0.1
          headers:
            Host: localhost
            User-Agent: OWASP CRS test agent
            Accept: text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5
          port: 80
          method: PUT
          uri: /apps/mail/api/messages/138/tags/%24test
          version: HTTP/1.1
        output:
          log:
            no_expect_ids: [911100]
  - test_id: 15
    desc: |
      Nextcloud Mail:
      Removing a tag from an email
    stages:
      - input:
          dest_addr: 127.0.0.1
          headers:
            Host: localhost
            User-Agent: OWASP CRS test agent
            Accept: text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5
          port: 80
          method: DELETE
          uri: /apps/mail/api/messages/138/tags/%24test
          version: HTTP/1.1
        output:
          log:
            no_expect_ids: [911100]
  - test_id: 16
    desc: |
      Nextcloud Mail:
      Changing the layout of Nextcloud Mail
    stages:
      - input:
          dest_addr: 127.0.0.1
          headers:
            Host: localhost
            User-Agent: OWASP CRS test agent
            Accept: text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5
            Content-Type: application/json
          port: 80
          method: PUT
          uri: /apps/mail/api/preferences/layout-mode
          data: |-
            {"key":"layout-mode","value":"horizontal-split"}
          version: HTTP/1.1
        output:
          log:
            no_expect_ids: [911100]
  - test_id: 17
    desc: |
      Nextcloud Mail:
      Adjusting size of email message compose box
    stages:
      - input:
          dest_addr: 127.0.0.1
          headers:
            Host: localhost
            User-Agent: OWASP CRS test agent
            Accept: text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5
            Content-Type: application/json
          port: 80
          method: PUT
          uri: /apps/mail/api/preferences/modalSize
          data: |-
            {"key":"modalSize","value":"large"}
          version: HTTP/1.1
        output:
          log:
            no_expect_ids: [911100]
  - test_id: 18
    desc: |
      Nextcloud Mail:
      Enabling/disabling internal addresses
    stages:
      - input:
          dest_addr: 127.0.0.1
          headers:
            Host: localhost
            User-Agent: OWASP CRS test agent
            Accept: text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5
            Content-Type: application/json
          port: 80
          method: PUT
          uri: /apps/mail/api/preferences/internal-addresses
          data: |-
            {"key":"internal-addresses","value":"false"}
          version: HTTP/1.1
        output:
          log:
            no_expect_ids: [911100]
  - test_id: 19
    desc: |
      File Manager GUI:
      Enabling image preview cropping
    stages:
      - input:
          dest_addr: 127.0.0.1
          headers:
            Host: localhost
            User-Agent: OWASP CRS test agent
            Accept: text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5
            Content-Type: application/json
          port: 80
          method: PUT
          uri: /apps/files/api/v1/config/crop_image_previews
          data: |-
            { "value":true }
          version: HTTP/1.1
        output:
          log:
            no_expect_ids: [911100]
  - test_id: 20
    desc: |
      File Manager GUI:
      Enabling Grid view
    stages:
      - input:
          dest_addr: 127.0.0.1
          headers:
            Host: localhost
            User-Agent: OWASP CRS test agent
            Accept: text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5
            Content-Type: application/json
          port: 80
          method: PUT
          uri: /apps/files/api/v1/config/grid_view
          data: |-
            { "value":true }
          version: HTTP/1.1
        output:
          log:
            no_expect_ids: [911100]
  - test_id: 21
    desc: |
      File Manager GUI:
      Enabling show hidden files
    stages:
      - input:
          dest_addr: 127.0.0.1
          headers:
            Host: localhost
            User-Agent: OWASP CRS test agent
            Accept: text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5
            Content-Type: application/json
          port: 80
          method: PUT
          uri: /apps/files/api/v1/config/show_hidden
          data: |-
            { "value":true }
          version: HTTP/1.1
        output:
          log:
            no_expect_ids: [911100]
  - test_id: 22
    desc: |
      File Manager GUI:
      Enabling "Sort Favorites first"
    stages:
      - input:
          dest_addr: 127.0.0.1
          headers:
            Host: localhost
            User-Agent: OWASP CRS test agent
            Accept: text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5
            Content-Type: application/json
          port: 80
          method: PUT
          uri: /apps/files/api/v1/config/sort_favorites_first
          data: |-
            { "value":true }
          version: HTTP/1.1
        output:
          log:
            no_expect_ids: [911100]
  - test_id: 23
    desc: |
      File Manager GUI:
      Enabling "Sort folders first"
    stages:
      - input:
          dest_addr: 127.0.0.1
          headers:
            Host: localhost
            User-Agent: OWASP CRS test agent
            Accept: text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5
            Content-Type: application/json
          port: 80
          method: PUT
          uri: /apps/files/api/v1/config/sort_folders_first
          data: |-
            { "value":true }
          version: HTTP/1.1
        output:
          log:
            no_expect_ids: [911100]
  - test_id: 24
    desc: |
      File Manager GUI:
      Browsing folders via sidebar
    stages:
      - input:
          dest_addr: 127.0.0.1
          headers:
            Host: localhost
            User-Agent: OWASP CRS test agent
            Accept: text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5
            Content-Type: application/json
          port: 80
          method: PUT
          uri: /apps/files/api/v1/views
          data: |-
            {"value":true,"view":"https://example.com/remote.php/dav/files/example/Templates","key":"expanded"}
          version: HTTP/1.1
        output:
          log:
            no_expect_ids: [911100]
  - test_id: 25
    desc: |
      File Manager GUI:
      Viewing shares via sidebar
    stages:
      - input:
          dest_addr: 127.0.0.1
          headers:
            Host: localhost
            User-Agent: OWASP CRS test agent
            Accept: text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5
            Content-Type: application/json
          port: 80
          method: PUT
          uri: /apps/files/api/v1/config/folder_tree
          data: |-
            {"value":false}
          version: HTTP/1.1
        output:
          log:
            no_expect_ids: [911100]
  - test_id: 26
    desc: |
      Smart Picker:
      Referencing a file using the smart picker
    stages:
      - input:
          dest_addr: 127.0.0.1
          headers:
            Host: localhost
            User-Agent: OWASP CRS test agent
            Accept: text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5
          port: 80
          method: PUT
          uri: /ocs/v2.php/references/provider/files
          version: HTTP/1.1
        output:
          log:
            no_expect_ids: [911100]
  - test_id: 27
    desc: |
      Smart Picker:
      Using the "Any Link" option within the smart picker
    stages:
      - input:
          dest_addr: 127.0.0.1
          headers:
            Host: localhost
            User-Agent: OWASP CRS test agent
            Accept: text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5
          port: 80
          method: PUT
          uri: /ocs/v2.php/references/provider/any-link
          version: HTTP/1.1
        output:
          log:
            no_expect_ids: [911100]
  - test_id: 28
    desc: |
      Nextcloud Photos:
      Disabling cropped layout view
    stages:
      - input:
          dest_addr: 127.0.0.1
          headers:
            Host: localhost
            User-Agent: OWASP CRS test agent
            Accept: text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5
            Content-Type: application/json
          port: 80
          method: PUT
          uri: /apps/photos/api/v1/config/croppedLayout
          data: |-
            {"value":"false"}
          version: HTTP/1.1
        output:
          log:
            no_expect_ids: [911100]
  - test_id: 29
    desc: |
      Nextcloud Photos:
      Enabling cropped layout view
    stages:
      - input:
          dest_addr: 127.0.0.1
          headers:
            Host: localhost
            User-Agent: OWASP CRS test agent
            Accept: text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5
            Content-Type: application/json
          port: 80
          method: PUT
          uri: /apps/photos/api/v1/config/croppedLayout
          data: |-
            {"value":"true"}
          version: HTTP/1.1
        output:
          log:
            no_expect_ids: [911100]
  - test_id: 30
    desc: |
      User Management:
      Disabling a user account
    stages:
      - input:
          dest_addr: 127.0.0.1
          headers:
            Host: localhost
            User-Agent: OWASP CRS test agent
            Accept: text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5
          port: 80
          method: PUT
          uri: /ocs/v2.php/cloud/users/johndoe/disable
          version: HTTP/1.1
        output:
          log:
            no_expect_ids: [911100]
  - test_id: 31
    desc: |
      User Management:
      Enabling a user account
    stages:
      - input:
          dest_addr: 127.0.0.1
          headers:
            Host: localhost
            User-Agent: OWASP CRS test agent
            Accept: text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5
          port: 80
          method: PUT
          uri: /ocs/v2.php/cloud/users/johndoe/enable
          version: HTTP/1.1
        output:
          log:
            no_expect_ids: [911100]
  - test_id: 32
    desc: |
      User Management:
      Deleting a user account
    stages:
      - input:
          dest_addr: 127.0.0.1
          headers:
            Host: localhost
            User-Agent: OWASP CRS test agent
            Accept: text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5
          port: 80
          method: DELETE
          uri: /ocs/v2.php/cloud/users/johndoe
          version: HTTP/1.1
        output:
          log:
            no_expect_ids: [911100]
  - test_id: 33
    desc: |
      User Management:
      Deleting a user group
    stages:
      - input:
          dest_addr: 127.0.0.1
          headers:
            Host: localhost
            User-Agent: OWASP CRS test agent
            Accept: text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5
          port: 80
          method: DELETE
          uri: /ocs/v2.php/cloud/groups/accountants
          version: HTTP/1.1
        output:
          log:
            no_expect_ids: [911100]
  - test_id: 34
    desc: |
      Nextcloud Deck:
      Deleting an attachment from an card
    stages:
      - input:
          dest_addr: 127.0.0.1
          headers:
            Host: localhost
            User-Agent: OWASP CRS test agent
            Accept: text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5
          port: 80
          method: DELETE
          uri: /apps/deck/cards/5/attachment/file:2
          version: HTTP/1.1
        output:
          log:
            no_expect_ids: [911100]
  - test_id: 35
    desc: |
      Nextcloud Deck:
      Editing a comment on a card
    stages:
      - input:
          dest_addr: 127.0.0.1
          headers:
            Host: localhost
            User-Agent: OWASP CRS test agent
            Accept: text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5
            Content-Type: application/json
          port: 80
          method: PUT
          uri: /ocs/v2.php/apps/deck/api/v1.0/cards/5/comments/61
          data: |-
            {"message":"<div data-v-3b61be27=\"\"></div>"}
          version: HTTP/1.1
        output:
          log:
            no_expect_ids: [911100]
  - test_id: 36
    desc: |
      Nextcloud Deck:
      Deleting a comment on a card
    stages:
      - input:
          dest_addr: 127.0.0.1
          headers:
            Host: localhost
            User-Agent: OWASP CRS test agent
            Accept: text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5
          port: 80
          method: DELETE
          uri: /ocs/v2.php/apps/deck/api/v1.0/cards/5/comments/62
          version: HTTP/1.1
        output:
          log:
            no_expect_ids: [911100]
  - test_id: 37
    desc: |
      Nextcloud Deck:
      Reordering card stacks
    stages:
      - input:
          dest_addr: 127.0.0.1
          headers:
            Host: localhost
            User-Agent: OWASP CRS test agent
            Accept: text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5
            Content-Type: application/json
          port: 80
          method: PUT
          uri: /apps/deck/stacks/1/reorder
          data: |-
            {"order":1}
          version: HTTP/1.1
        output:
          log:
            no_expect_ids: [911100]
  - test_id: 38
    desc: |
      Nextcloud Deck:
      Removing a group/user from a board share
    stages:
      - input:
          dest_addr: 127.0.0.1
          headers:
            Host: localhost
            User-Agent: OWASP CRS test agent
            Accept: text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5
          port: 80
          method: DELETE
          uri: /apps/deck/boards/1/acl/1
          version: HTTP/1.1
        output:
          log:
            no_expect_ids: [911100]
  - test_id: 39
    desc: |
      Nextcloud Deck:
      Removing a group/user from a label share
    stages:
      - input:
          dest_addr: 127.0.0.1
          headers:
            Host: localhost
            User-Agent: OWASP CRS test agent
            Accept: text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5
          port: 80
          method: DELETE
          uri: /apps/deck/labels/4/acl/1
          version: HTTP/1.1
        output:
          log:
            no_expect_ids: [911100]
  - test_id: 40
    desc: |
      Nextcloud Deck:
      Editing an existing board
    stages:
      - input:
          dest_addr: 127.0.0.1
          headers:
            Host: localhost
            User-Agent: OWASP CRS test agent
            Accept: text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5
            Content-Type: application/json
          port: 80
          method: PUT
          uri: /apps/deck/boards/1
          data: |-
            {"id":3,"title":"test","owner":{"primaryKey":"esadc","uid":"esadc","displayname":"EsadCetiner","type":0},"color":"ea1025","archived":false,"labels":[],"acl":[],"permissions":{"PERMISSION_READ":true,"PERMISSION_EDIT":true,"PERMISSION_MANAGE":true,"PERMISSION_SHARE":true},"users":[],"shared":0,"stacks":[],"activeSessions":[],"deletedAt":0,"lastModified":1719946339,"settings":[],"ETag":"123456789abcdef"}
          version: HTTP/1.1
        output:
          log:
            no_expect_ids: [911100]
  - test_id: 41
    desc: |
      Nextcloud Deck:
      Editing an existing label
    stages:
      - input:
          dest_addr: 127.0.0.1
          headers:
            Host: localhost
            User-Agent: OWASP CRS test agent
            Accept: text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5
            Content-Type: application/json
          port: 80
          method: PUT
          uri: /apps/deck/labels/4
          data: |-
            {"id":4,"title":"test","color":"F1DB50","boardId":1,"cardId":null,"lastModified":1662255238,"ETag":"1234567890abcdef"}
          version: HTTP/1.1
        output:
          log:
            no_expect_ids: [911100]
  - test_id: 42
    desc: |
      Nextcloud Deck:
      Sharing a board with a user/group
    stages:
      - input:
          dest_addr: 127.0.0.1
          headers:
            Host: localhost
            User-Agent: OWASP CRS test agent
            Accept: text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5
            Content-Type: application/json
          port: 80
          method: PUT
          uri: /apps/deck/boards/1/acl/1
          data: |-
            {"id":1,"participant":{"primaryKey":"test","uid":"test","displayname":"test","type":1},"type":1,"boardId":1,"permissionEdit":true,"permissionShare":false,"permissionManage":false,"owner":false}
          version: HTTP/1.1
        output:
          log:
            no_expect_ids: [911100]
  - test_id: 43
    desc: |
      Nextcloud Deck:
      Sharing a label with a user/group
    stages:
      - input:
          dest_addr: 127.0.0.1
          headers:
            Host: localhost
            User-Agent: OWASP CRS test agent
            Accept: text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5
            Content-Type: application/json
          port: 80
          method: PUT
          uri: /apps/deck/labels/4/acl/1
          data: |-
            {"id":4,"title":"test","color":"F1DB50","boardId":1,"cardId":null,"lastModified":1662255238,"ETag":"1234567890abcdef"}
          version: HTTP/1.1
        output:
          log:
            no_expect_ids: [911100]
  - test_id: 44
    desc: |
      Nextcloud Deck:
      Marking a card as done
    stages:
      - input:
          dest_addr: 127.0.0.1
          headers:
            Host: localhost
            User-Agent: OWASP CRS test agent
            Accept: text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5
          port: 80
          method: PUT
          uri: /apps/deck/cards/7/done
          version: HTTP/1.1
        output:
          log:
            no_expect_ids: [911100]
  - test_id: 45
    desc: |
      Nextcloud Deck:
      Marking a card as not done
    stages:
      - input:
          dest_addr: 127.0.0.1
          headers:
            Host: localhost
            User-Agent: OWASP CRS test agent
            Accept: text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5
          port: 80
          method: PUT
          uri: /apps/deck/cards/7/undone
          version: HTTP/1.1
        output:
          log:
            no_expect_ids: [911100]
  - test_id: 46
    desc: |
      Nextcloud Deck:
      Archiving a card
    stages:
      - input:
          dest_addr: 127.0.0.1
          headers:
            Host: localhost
            User-Agent: OWASP CRS test agent
            Accept: text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5
          port: 80
          method: PUT
          uri: /apps/deck/cards/7/archive
          version: HTTP/1.1
        output:
          log:
            no_expect_ids: [911100]
  - test_id: 47
    desc: |
      Nextcloud Deck:
      Unarchiving a card
    stages:
      - input:
          dest_addr: 127.0.0.1
          headers:
            Host: localhost
            User-Agent: OWASP CRS test agent
            Accept: text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5
          port: 80
          method: PUT
          uri: /apps/deck/cards/7/unarchive
          version: HTTP/1.1
        output:
          log:
            no_expect_ids: [911100]
  - test_id: 48
    desc: |
      Nextcloud Deck:
      Deleting a board
    stages:
      - input:
          dest_addr: 127.0.0.1
          headers:
            Host: localhost
            User-Agent: OWASP CRS test agent
            Accept: text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5
          port: 80
          method: DELETE
          uri: /apps/deck/boards/1
          version: HTTP/1.1
        output:
          log:
            no_expect_ids: [911100]
  - test_id: 49
    desc: |
      Nextcloud Deck:
      Deleting a stack
    stages:
      - input:
          dest_addr: 127.0.0.1
          headers:
            Host: localhost
            User-Agent: OWASP CRS test agent
            Accept: text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5
          port: 80
          method: DELETE
          uri: /apps/deck/stacks/1
          version: HTTP/1.1
        output:
          log:
            no_expect_ids: [911100]
  - test_id: 50
    desc: |
      Nextcloud Deck:
      Deleting a card
    stages:
      - input:
          dest_addr: 127.0.0.1
          headers:
            Host: localhost
            User-Agent: OWASP CRS test agent
            Accept: text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5
          port: 80
          method: DELETE
          uri: /apps/deck/cards/1
          version: HTTP/1.1
        output:
          log:
            no_expect_ids: [911100]
  - test_id: 51
    desc: |
      Nextcloud Deck:
      Deleting a label
    stages:
      - input:
          dest_addr: 127.0.0.1
          headers:
            Host: localhost
            User-Agent: OWASP CRS test agent
            Accept: text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5
          port: 80
          method: DELETE
          uri: /apps/deck/labels/1
          version: HTTP/1.1
        output:
          log:
            no_expect_ids: [911100]
  - test_id: 52
    desc: |
      Nextcloud Deck:
      Removing a label from a card
    stages:
      - input:
          dest_addr: 127.0.0.1
          headers:
            Host: localhost
            User-Agent: OWASP CRS test agent
            Accept: text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5
          port: 80
          method: DELETE
          uri: /apps/deck/cards/7/label/23
          version: HTTP/1.1
        output:
          log:
            no_expect_ids: [911100]
  - test_id: 53
    desc: |
      Nextcloud Cookbook:
      Editing a recipe category
    stages:
      - input:
          dest_addr: 127.0.0.1
          headers:
            Host: localhost
            User-Agent: OWASP CRS test agent
            Accept: text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5
            Content-Type: application/json
          port: 80
          method: PUT
          uri: /apps/cookbook/webapp/category/Soup
          data: |-
            {"name":"Soup"}
          version: HTTP/1.1
        output:
          log:
            no_expect_ids: [911100]
  - test_id: 54
    desc: |
      Notification:
      Dismissing notifications on iOS
    stages:
      - input:
          dest_addr: 127.0.0.1
          headers:
            Host: localhost
            User-Agent: OWASP CRS test agent
            Accept: text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5
          port: 80
          method: DELETE
          uri: /ocs/v2.php/apps/notifications/api/v2/push
          version: HTTP/1.1
        output:
          log:
            no_expect_ids: [911100]
  - test_id: 55
    desc: |
      Administration Settings:
      Deleting an oauth client
    stages:
      - input:
          dest_addr: 127.0.0.1
          headers:
            Host: localhost
            User-Agent: OWASP CRS test agent
            Accept: text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5
          port: 80
          method: DELETE
          uri: /apps/oauth2/clients/42
          version: HTTP/1.1
        output:
          log:
            no_expect_ids: [911100]
  - test_id: 56
    desc: |
      Administration Settings:
      Deleting an oauth client
    stages:
      - input:
          dest_addr: 127.0.0.1
          headers:
            Host: localhost
            User-Agent: OWASP CRS test agent
            Accept: text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5
          port: 80
          method: DELETE
          uri: /apps/oauth2/clients
          version: HTTP/1.1
        output:
          log:
            no_expect_ids: [911100]
  - test_id: 57
    desc: |
      Administration Settings:
      Configuring default apps
    stages:
      - input:
          dest_addr: 127.0.0.1
          headers:
            Host: localhost
            User-Agent: OWASP CRS test agent
            Accept: text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5
            Content-Type: application/json
          port: 80
          method: PUT
          uri: /apps/theming/ajax/updateAppMenu
          data: |-
            { "setting":"defaultApps","value":["files","dashboard"] }
          version: HTTP/1.1
        output:
          log:
            no_expect_ids: [911100]
  - test_id: 58
    desc: |
      Administration Settings:
      Disabling Gmail email integration
    stages:
      - input:
          dest_addr: 127.0.0.1
          headers:
            Host: localhost
            User-Agent: OWASP CRS test agent
            Accept: text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5
          port: 80
          method: DELETE
          uri: /apps/mail/api/integration/google
          version: HTTP/1.1
        output:
          log:
            no_expect_ids: [911100]
  - test_id: 59
    desc: |
      Administration Settings:
      Disabling Microsoft email integration
    stages:
      - input:
          dest_addr: 127.0.0.1
          headers:
            Host: localhost
            User-Agent: OWASP CRS test agent
            Accept: text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5
          port: 80
          method: DELETE
          uri: /apps/mail/api/integration/microsoft
          version: HTTP/1.1
        output:
          log:
            no_expect_ids: [911100]
  - test_id: 60
    desc: |
      Administration Settings:
      Disabling automatic deletion of a tag type
    stages:
      - input:
          dest_addr: 127.0.0.1
          headers:
            Host: localhost
            User-Agent: OWASP CRS test agent
            Accept: text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5
          port: 80
          method: DELETE
          uri: /ocs/v2.php/apps/files_retention/api/v2/retentions/42
          version: HTTP/1.1
        output:
          log:
            no_expect_ids: [911100]
  - test_id: 61
    desc: |
      Administration Settings:
      Disabling log reader live view
    stages:
      - input:
          dest_addr: 127.0.0.1
          headers:
            Host: localhost
            User-Agent: OWASP CRS test agent
            Accept: text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5
            Content-Type: application/json
          port: 80
          method: PUT
          uri: /apps/logreader/api/settings
          data: |-
            { "settingsKey": "liveLog","settingsValue": false }
          version: HTTP/1.1
        output:
          log:
            no_expect_ids: [911100]
  - test_id: 62
    desc: |
      Administration Settings:
      Enabling log reader live view
    stages:
      - input:
          dest_addr: 127.0.0.1
          headers:
            Host: localhost
            User-Agent: OWASP CRS test agent
            Accept: text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5
            Content-Type: application/json
          port: 80
          method: PUT
          uri: /apps/logreader/api/settings
          data: |-
            { "settingsKey": "liveLog","settingsValue": true }
          version: HTTP/1.1
        output:
          log:
            no_expect_ids: [911100]
  - test_id: 63
    desc: |
      Administration Settings:
      Configuring/excluding 2FA enforcement for groups
    stages:
      - input:
          dest_addr: 127.0.0.1
          headers:
            Host: localhost
            User-Agent: OWASP CRS test agent
            Accept: text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5
            Content-Type: application/json
          port: 80
          method: PUT
          uri: /settings/api/admin/twofactorauth
          data: |-
            {"enforced":true,"enforcedGroups":["admin"],"excludedGroups":["Users"]}
          version: HTTP/1.1
        output:
          log:
            no_expect_ids: [911100]
  - test_id: 64
    desc: |
      Administration Settings:
      Changing the cron method (AJAX, Webcron, Cron)
    stages:
      - input:
          dest_addr: 127.0.0.1
          headers:
            Host: localhost
            User-Agent: OWASP CRS test agent
            Accept: text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5
          port: 80
          method: DELETE
          uri: /ocs/v2.php/apps/provisioning_api/api/v1/config/apps/core/cronErrors
          version: HTTP/1.1
        output:
          log:
            no_expect_ids: [911100]
  - test_id: 65
    desc: |
      Administration Settings:
      Testing /.well-known/carddav redirection
    stages:
      - input:
          dest_addr: 127.0.0.1
          headers:
            Host: localhost
            User-Agent: OWASP CRS test agent
            Accept: text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5
          port: 80
          method: PROPFIND
          uri: /.well-known/carddav
          version: HTTP/1.1
        output:
          log:
            no_expect_ids: [911100]
  - test_id: 66
    desc: |
      Administration Settings:
      Testing /.well-known/caldav redirection
    stages:
      - input:
          dest_addr: 127.0.0.1
          headers:
            Host: localhost
            User-Agent: OWASP CRS test agent
            Accept: text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5
          port: 80
          method: PROPFIND
          uri: /.well-known/caldav
          version: HTTP/1.1
        output:
          log:
            no_expect_ids: [911100]
  - test_id: 67
    desc: |
      Administration Settings:
      Testing /.well-known/webdav redirection
    stages:
      - input:
          dest_addr: 127.0.0.1
          headers:
            Host: localhost
            User-Agent: OWASP CRS test agent
            Accept: text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5
          port: 80
          method: PROPFIND
          uri: /.well-known/webdav
          version: HTTP/1.1
        output:
          log:
            no_expect_ids: [911100]
  - test_id: 68
    desc: |
      Administration Settings:
      Deleting administrators from "Who has access to your data"
    stages:
      - input:
          dest_addr: 127.0.0.1
          headers:
            Host: localhost
            User-Agent: OWASP CRS test agent
            Accept: text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5
          port: 80
          method: DELETE
          uri: /apps/privacy/api/admins/1
          version: HTTP/1.1
        output:
          log:
            no_expect_ids: [911100]
  - test_id: 69
    desc: |
      Personal Settings:
      Deleting an email address from personal info
    stages:
      - input:
          dest_addr: 127.0.0.1
          headers:
            Host: localhost
            User-Agent: OWASP CRS test agent
            Accept: text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5
            Content-Type: application/json
          port: 80
          method: PUT
          uri: /ocs/v2.php/cloud/users/test/additional_mail
          data: |-
            {"key":"email@example.com","value":""}
          version: HTTP/1.1
        output:
          log:
            no_expect_ids: [911100]
  - test_id: 70
    desc: |
      Personal Settings:
      Deleting out of office message
    stages:
      - input:
          dest_addr: 127.0.0.1
          headers:
            Host: localhost
            User-Agent: OWASP CRS test agent
            Accept: text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5
          port: 80
          method: DELETE
          uri: /ocs/v2.php/apps/dav/api/v1/outOfOffice/username
          version: HTTP/1.1
        output:
          log:
            no_expect_ids: [911100]
  - test_id: 71
    desc: |
      Personal Settings:
      Disabling dyslexic font
    stages:
      - input:
          dest_addr: 127.0.0.1
          headers:
            Host: localhost
            User-Agent: OWASP CRS test agent
            Accept: text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5
            Content-Type: application/json
          port: 80
          method: DELETE
          uri: /ocs/v2.php/apps/theming/api/v1/theme/opendyslexic
          version: HTTP/1.1
        output:
          log:
            no_expect_ids: [911100]
  - test_id: 72
    desc: |
      Personal Settings:
      Enabling "Automatically set user status to Do no disturb" option
    stages:
      - input:
          dest_addr: 127.0.0.1
          headers:
            Host: localhost
            User-Agent: OWASP CRS test agent
            Accept: text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5
            Content-Type: application/json
          port: 80
          method: POST
          uri: /ocs/v2.php/apps/provisioning_api/api/v1/config/users/dav/user_status_automation
          data: |-
            {"configValue":"yes"}
          version: HTTP/1.1
        output:
          log:
            no_expect_ids: [911100]
  - test_id: 73
    desc: |
      Personal Settings:
      Disabling "Automatically set user status to Do no disturb" option
    stages:
      - input:
          dest_addr: 127.0.0.1
          headers:
            Host: localhost
            User-Agent: OWASP CRS test agent
            Accept: text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5
          port: 80
          method: DELETE
          uri: /ocs/v2.php/apps/provisioning_api/api/v1/config/users/dav/user_status_automation
          version: HTTP/1.1
        output:
          log:
            no_expect_ids: [911100]
  - test_id: 74
    desc: |
      Personal Settings:
      Disabling filesystem access
    stages:
      - input:
          dest_addr: 127.0.0.1
          headers:
            Host: localhost
            User-Agent: OWASP CRS test agent
            Accept: text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5
            Content-Type: application/json
          port: 80
          method: PUT
          uri: /settings/personal/authtokens/1
          data: |-
            {"id":1,"name":"test","lastActivity":1721401548,"type":1,"scope":{"filesystem":false},"canDelete":true,"canRename":true}
          version: HTTP/1.1
        output:
          log:
            no_expect_ids: [911100]
  - test_id: 75
    desc: |
      Personal Settings:
      Renaming a token/session
    stages:
      - input:
          dest_addr: 127.0.0.1
          headers:
            Host: localhost
            User-Agent: OWASP CRS test agent
            Accept: text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5
            Content-Type: application/json
          port: 80
          method: PUT
          uri: /settings/personal/authtokens/1
          data: |-
            {"id":1,"name":"test123","lastActivity":1721401548,"type":1,"scope":{"filesystem":false},"canDelete":true,"canRename":true}
          version: HTTP/1.1
        output:
          log:
            no_expect_ids: [911100]
  - test_id: 76
    desc: |
      Personal Settings:
      Deleting a token/session
    stages:
      - input:
          dest_addr: 127.0.0.1
          headers:
            Host: localhost
            User-Agent: OWASP CRS test agent
            Accept: text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5
          port: 80
          method: DELETE
          uri: /settings/personal/authtokens/1
          version: HTTP/1.1
        output:
          log:
            no_expect_ids: [911100]
  - test_id: 77
    desc: |
      Text Editor:
      Opening an file
      Public Share: NO
      NC 27.1 and older
    stages:
      - input:
          dest_addr: 127.0.0.1
          headers:
            Host: localhost
            User-Agent: OWASP CRS test agent
            Accept: text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5
          port: 80
          method: PUT
          uri: /apps/text/session/create
          version: HTTP/1.1
        output:
          log:
            no_expect_ids: [911100]
  - test_id: 78
    desc: |
      Text Editor:
      Opening an file
      Public Share: YES
      NC 27.1 and older
    stages:
      - input:
          dest_addr: 127.0.0.1
          headers:
            Host: localhost
            User-Agent: OWASP CRS test agent
            Accept: text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5
          port: 80
          method: PUT
          uri: /apps/text/public/session/create
          version: HTTP/1.1
        output:
          log:
            no_expect_ids: [911100]
  - test_id: 79
    desc: |
      Text Editor:
      Opening an file
      Public Share: NO
      NC 28 and newer
    stages:
      - input:
          dest_addr: 127.0.0.1
          headers:
            Host: localhost
            User-Agent: OWASP CRS test agent
            Accept: text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5
          port: 80
          method: PUT
          uri: /apps/text/session/1234/create
          version: HTTP/1.1
        output:
          log:
            no_expect_ids: [911100]
  - test_id: 80
    desc: |
      Text Editor:
      Opening an file
      Public Share: YES
      NC 28 and newer
    stages:
      - input:
          dest_addr: 127.0.0.1
          headers:
            Host: localhost
            User-Agent: OWASP CRS test agent
            Accept: text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5
          port: 80
          method: PUT
          uri: /apps/text/public/session/1234/create
          version: HTTP/1.1
        output:
          log:
            no_expect_ids: [911100]
  - test_id: 81
    desc: |
      File Manager GUI:
      Configuring a download limit for public shares
    stages:
      - input:
          dest_addr: 127.0.0.1
          headers:
            Host: localhost
            User-Agent: OWASP CRS test agent
            Accept: text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5
            Content-Type: application/json
          port: 80
          method: PUT
          uri: /ocs/v2.php/apps/files_downloadlimit/api/v1/zqiJrSncJep32DL/limit
          data: |-
            {"limit":5}
          version: HTTP/1.1
        output:
          log:
            no_expect_ids: [911100]
  - test_id: 82
    desc: |
      Personal Settings:
      Clearing profile picture
    stages:
      - input:
          dest_addr: 127.0.0.1
          headers:
            Host: localhost
            User-Agent: OWASP CRS test agent
            Accept: text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5
          port: 80
          method: DELETE
          uri: /avatar
          version: HTTP/1.1
        output:
          log:
            no_expect_ids: [911100]
