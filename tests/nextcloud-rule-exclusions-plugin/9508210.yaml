---
meta:
  author: "Esad Cetiner"
  description: "Nextcloud Bookmarks"
rule_id: 9508210
tests:
  - test_id: 1
    desc: Creating a bookmark via Web GUI
    stages:
      - input:
          dest_addr: 127.0.0.1
          headers:
            Host: localhost
            User-Agent: OWASP CRS test agent
            Accept: text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5
            Content-Type: application/json
          port: 80
          method: POST
          uri: /apps/bookmarks/bookmark
          data: |-
            {"url":"https://example.com"}
          version: HTTP/1.1
        output:
          log:
            no_expect_ids:
              - 920273
              - 931130
              - 932200
              - 932240
              - 932220
              - 932236
              - 932240
              - 932260
              - 941170
              - 941210
              - 942430
              - 942431
              - 942432
              - 942440
  - test_id: 2
    desc: Editing an existing bookmark via Web GUI
    stages:
      - input:
          dest_addr: 127.0.0.1
          headers:
            Host: localhost
            User-Agent: OWASP CRS test agent
            Accept: text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5
            Content-Type: application/json
          port: 80
          method: PUT
          uri: /apps/bookmarks/bookmark/4
          data: >-
            {"id":4,"url":"https://example.com/","target":"https://example.com/","title":"https://example.com/1","description":"","lastmodified":1743007234,"added":1743007234,
            "clickcount":0,"lastPreview":0,"available":true,"archivedFile":null,"userId":"esadc","tags":[],"folders":[-1,3],"textContent":null,"htmlContent":null}
          version: HTTP/1.1
        output:
          log:
            no_expect_ids:
              - 920273
              - 931130
              - 932200
              - 932240
              - 932220
              - 932236
              - 932240
              - 932260
              - 941170
              - 941210
              - 942430
              - 942431
              - 942432
              - 942440
  - test_id: 3
    desc: Clicking a bookmark entry via Web GUI
    stages:
      - input:
          dest_addr: 127.0.0.1
          headers:
            Host: localhost
            User-Agent: OWASP CRS test agent
            Accept: text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5
            Content-Type: application/json
          port: 80
          method: POST
          uri: /apps/bookmarks/bookmark/click
          data: |-
            {"url":"https://example.com/"}
          version: HTTP/1.1
        output:
          log:
            no_expect_ids:
              - 920273
              - 931130
              - 932200
              - 932240
              - 932220
              - 932236
              - 932240
              - 932260
              - 941170
              - 941210
              - 942430
              - 942431
              - 942432
              - 942440
  - test_id: 4
    desc: Connecting floccus extension to Nextcloud
    stages:
      - input:
          dest_addr: 127.0.0.1
          headers:
            Host: localhost
            User-Agent: OWASP CRS test agent
            Accept: text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5
            Content-Type: application/json
          port: 80
          method: POST
          uri: /index.php/apps/bookmarks/public/rest/v2/bookmark
          data: |-
            {"url":"javascript:void(0)","title":"floccus","folders":["-1"]}
          version: HTTP/1.1
        output:
          log:
            no_expect_ids:
              - 920273
              - 931130
              - 932200
              - 932240
              - 932220
              - 932236
              - 932240
              - 932260
              - 941170
              - 941210
              - 942430
              - 942431
              - 942432
              - 942440
  - test_id: 5
    desc: Syncing a bookmark entry via an extension
    stages:
      - input:
          dest_addr: 127.0.0.1
          headers:
            Host: localhost
            User-Agent: OWASP CRS test agent
            Accept: text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5
          port: 80
          method: GET
          uri: /index.php/apps/bookmarks/public/rest/v2/bookmark?url=https%3A%2F%2Fexample.com%2F
          version: HTTP/1.1
        output:
          log:
            no_expect_ids:
              - 920273
              - 931130
              - 932200
              - 932240
              - 932220
              - 932236
              - 932240
              - 932260
              - 941170
              - 941210
              - 942430
              - 942431
              - 942432
              - 942440
  - test_id: 6
    desc: Creating an bookmark entry via an extension
    stages:
      - input:
          dest_addr: 127.0.0.1
          headers:
            Host: localhost
            User-Agent: OWASP CRS test agent
            Accept: text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5
            Content-Type: application/json
          port: 80
          method: POST
          uri: /index.php/apps/bookmarks/public/rest/v2/bookmark
          data: |-
            {"url":"https://iplists.firehol.org/","title":"FireHOL IP Lists | IP Blacklists | IP Blocklists | IP Reputation","folders":[23]}
          version: HTTP/1.1
        output:
          log:
            no_expect_ids:
              - 920273
              - 931130
              - 932200
              - 932240
              - 932220
              - 932236
              - 932240
              - 932260
              - 941170
              - 941210
              - 942430
              - 942431
              - 942432
              - 942440
  - test_id: 7
    desc: Creating an bookmark entry via an extension
    stages:
      - input:
          dest_addr: 127.0.0.1
          headers:
            Host: localhost
            User-Agent: OWASP CRS test agent
            Accept: text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5
            Content-Type: application/json
          port: 80
          method: PUT
          uri: /index.php/apps/bookmarks/public/rest/v2/bookmark/178
          data: |-
            {"url":"https://0xinfection.xyz/posts/breaking-the-waf-wall-modsecurity-crs/","title":"Breaking the WAF Wall: ModSecurity CRS :: 0xInfection's Blog â€” Ramblings of an Infected Geek","folders":[47],"tags":[]}
          version: HTTP/1.1
        output:
          log:
            no_expect_ids:
              - 920273
              - 931130
              - 932200
              - 932240
              - 932220
              - 932236
              - 932240
              - 932260
              - 941170
              - 941210
              - 942430
              - 942431
              - 942432
              - 942440
