# ------------------------------------------------------------------------
# OWASP CRS Plugin
# Copyright (c) 2022-2025 CRS project. All rights reserved.
#
# The OWASP CRS plugins are distributed under
# Apache Software License (ASL) version 2
# Please see the enclosed LICENSE file for full details.
# ------------------------------------------------------------------------
SecRule &TX:nextcloud-rule-exclusions-plugin_ios_workaround_enabled "@eq 0" "id:9508098,phase:1,pass,nolog,ctl:ruleRemoveById=9508119"
SecRule TX:nextcloud-rule-exclusions-plugin_enabled "@eq 0" "id:9508099,phase:1,pass,nolog,ctl:ruleRemoveById=9508100-9508999"
SecRule &TX:allowed_methods "@eq 0" \
    "id:9508100,\
    phase:1,\
    pass,\
    nolog,\
    ver:'nextcloud-rule-exclusions-plugin/1.5.0',\
    setvar:'tx.allowed_methods=GET HEAD POST OPTIONS'"
SecRule &TX:allowed_request_content_type "@eq 0" \
    "id:9508101,\
    phase:1,\
    pass,\
    nolog,\
    ver:'nextcloud-rule-exclusions-plugin/1.5.0',\
    setvar:'tx.allowed_request_content_type=|application/x-www-form-urlencoded| |multipart/form-data| |text/xml| |application/xml| |application/soap+xml| |application/json| |application/reports+json| |application/csp-report|'"
SecRule REQUEST_METHOD "@streq REPORT" \
    "id:9508110,\
    phase:1,\
    pass,\
    t:none,\
    nolog,\
    ver:'nextcloud-rule-exclusions-plugin/1.5.0',\
    chain"
    SecRule REQUEST_FILENAME "@contains /remote.php/dav/files/" \
        "t:none,\
        ctl:ruleRemoveById=920340,\
        ctl:ruleRemoveById=920341"
SecRule REQUEST_FILENAME "@rx /remote\.php/dav/uploads/[^/]+/[^/]+/\.file$" \
    "id:9508111,\
    phase:1,\
    pass,\
    t:none,\
    nolog,\
    ver:'nextcloud-rule-exclusions-plugin/1.5.0',\
    chain"
    SecRule REQUEST_METHOD "@streq MOVE" \
        "t:none,\
        setvar:'tx.allowed_request_content_type=%{tx.allowed_request_content_type} |application/octet-stream|'"
SecRule REQUEST_FILENAME "@rx /(?:public|remote)\.php/(?:dav/files|dav/webdav|webdav)/" \
    "id:9508112,\
    phase:1,\
    pass,\
    t:none,\
    nolog,\
    ver:'nextcloud-rule-exclusions-plugin/1.5.0',\
    chain"
    SecRule REQUEST_METHOD "@streq GET" \
        "t:none,\
        ctl:ruleRemoveById=951000-951999,\
        ctl:ruleRemoveById=953100-953130,\
        ctl:ruleRemoveById=954100,\
        ctl:ruleRemoveById=954110,\
        ctl:ruleRemoveById=954120,\
        ctl:ruleRemoveById=955100,\
        ctl:ruleRemoveById=955110,\
        ctl:ruleRemoveById=955300,\
        ctl:ruleRemoveById=955350"
SecRule REQUEST_FILENAME "@rx /(?:public|remote)\.php/(?:dav/files|dav/webdav|webdav)/" \
    "id:9508113,\
    phase:1,\
    pass,\
    t:none,\
    nolog,\
    ver:'nextcloud-rule-exclusions-plugin/1.5.0',\
    ctl:ruleRemoveById=920440,\
    ctl:ruleRemoveTargetById=930120;REQUEST_FILENAME,\
    ctl:ruleRemoveTargetById=930130;REQUEST_FILENAME,\
    ctl:ruleRemoveTargetById=933150;REQUEST_FILENAME,\
    ctl:ruleRemoveTargetById=933210;REQUEST_FILENAME,\
    ctl:ruleRemoveTargetById=942120;REQUEST_FILENAME"
SecRule REQUEST_FILENAME "@rx /(?:remote\.php/(?:dav/bulk$|dav/files/|dav/uploads/(?:[^/]+/?){3}|webdav/|dav/webdav)|public\.php/(?:dav/files|webdav/))" \
    "id:9508114,\
    phase:1,\
    pass,\
    t:none,\
    nolog,\
    ver:'nextcloud-rule-exclusions-plugin/1.5.0',\
    chain"
    SecRule REQUEST_METHOD "@pm POST PUT" \
        "t:none,\
        ctl:ruleRemoveById=920240,\
        ctl:ruleRemoveById=920340,\
        ctl:ruleRemoveById=920341,\
        ctl:ruleRemoveById=920420,\
        ctl:ruleRemoveById=921422,\
        ctl:ruleRemoveTargetById=920260;REQUEST_BODY,\
        ctl:ruleRemoveTargetById=920272;REQUEST_BODY,\
        ctl:ruleRemoveTargetById=920273;REQUEST_BODY,\
        ctl:ruleRemoveTargetById=921110;REQUEST_BODY,\
        ctl:ruleRemoveTargetById=931110;REQUEST_BODY,\
        ctl:ruleRemoveTargetById=944100;REQUEST_BODY,\
        ctl:ruleRemoveTargetById=944110;REQUEST_BODY,\
        ctl:ruleRemoveTargetById=944120;REQUEST_BODY,\
        ctl:ruleRemoveTargetById=944130;REQUEST_BODY,\
        ctl:ruleRemoveTargetById=944200;REQUEST_BODY,\
        ctl:ruleRemoveTargetById=944210;REQUEST_BODY,\
        ctl:ruleRemoveTargetById=944240;REQUEST_BODY,\
        ctl:ruleRemoveTargetById=944250;REQUEST_BODY,\
        ctl:ruleRemoveTargetById=944260;REQUEST_BODY"
SecRule REQUEST_FILENAME "@contains /remote.php/dav/files/" \
    "id:9508116,\
    phase:3,\
    pass,\
    t:none,\
    nolog,\
    ver:'nextcloud-rule-exclusions-plugin/1.5.0',\
    chain"
    SecRule RESPONSE_STATUS "@rx ^50[023]$" \
        "t:none,\
        ctl:ruleRemoveById=950100"
SecRule REQUEST_FILENAME "@rx /remote\.php/dav/uploads/[^/]+/[0-9]+/\.file$" \
    "id:9508117,\
    phase:1,\
    pass,\
    t:none,\
    nolog,\
    ver:'nextcloud-rule-exclusions-plugin/1.5.0',\
    chain"
    SecRule &REQUEST_HEADERS:if "@eq 1" \
        "t:none,\
        ctl:ruleRemoveById=920450"
SecRule REQUEST_FILENAME "@rx /remote\.php/dav/?$" \
    "id:9508118,\
    phase:1,\
    pass,\
    t:none,\
    nolog,\
    ver:'nextcloud-rule-exclusions-plugin/1.5.0',\
    chain"
    SecRule REQUEST_METHOD "@streq SEARCH" \
        "t:none,\
        ctl:ruleRemoveTargetById=942430;XML:/*,\
        ctl:ruleRemoveTargetById=942431;XML:/*,\
        ctl:ruleRemoveTargetById=942432;XML:/*"
SecRule REQUEST_FILENAME "@rx /remote\.php/dav/(?:files/|uploads/[^/]+/[^/]+(?:/[^/]+)?$)" \
    "id:9508119,\
    phase:1,\
    pass,\
    t:none,\
    nolog,\
    ver:'nextcloud-rule-exclusions-plugin/1.5.0',\
    chain"
    SecRule REQUEST_HEADERS:User-Agent "@contains Nextcloud-iOS" \
        "t:none,\
        chain"
        SecRule REQUEST_HEADERS:Content-Type "@rx ^application/(?:x-www-form-urlencoded|xml)$" \
            "t:none,\
            chain"
            SecRule REQUEST_METHOD "@pm POST PUT" \
                "t:none,\
                ctl:ruleRemoveById=200002,\
                ctl:ruleRemoveById=200007,\
                ctl:ruleRemoveById=920240,\
                ctl:ruleRemoveById=920250,\
                ctl:ruleRemoveTargetById=920540;ARGS,\
                ctl:ruleRemoveTargetById=920540;ARGS_NAMES,\
                ctl:ruleRemoveTargetById=921110;REQUEST_BODY,\
                ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS,\
                ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS_NAMES"
SecRule REQUEST_FILENAME "@rx /ocs/v[0-9.]+\.php/apps/recommendations/api/v[0-9.]+/recommendations$" \
    "id:9508120,\
    phase:2,\
    pass,\
    t:none,\
    nolog,\
    ver:'nextcloud-rule-exclusions-plugin/1.5.0',\
    chain"
    SecRule REQUEST_HEADERS:Content-Type "@beginsWith application/xml" \
        "t:none,\
        chain"
        SecRule REQUEST_BODY_LENGTH "@eq 0" \
            "t:none,\
            ctl:ruleRemoveById=200002"
SecRule REQUEST_FILENAME "@rx /remote\.php/dav/versions/[^/]+/versions/[0-9]+/$" \
    "id:9508130,\
    phase:1,\
    pass,\
    t:none,\
    nolog,\
    ver:'nextcloud-rule-exclusions-plugin/1.5.0',\
    ctl:ruleRemoveTargetById=920272;REQUEST_BODY,\
    ctl:ruleRemoveTargetById=920273;REQUEST_BODY,\
    ctl:ruleRemoveTargetById=921110;REQUEST_BODY"
SecRule REQUEST_FILENAME "@rx /remote\.php/dav/systemtags(?:-relations/files/[0-9]+|-assigned/image)?/$" \
    "id:9508131,\
    phase:1,\
    pass,\
    t:none,\
    nolog,\
    ver:'nextcloud-rule-exclusions-plugin/1.5.0',\
    ctl:ruleRemoveTargetById=920272;REQUEST_BODY,\
    ctl:ruleRemoveTargetById=920273;REQUEST_BODY,\
    ctl:ruleRemoveTargetById=921110;REQUEST_BODY"
SecRule REQUEST_FILENAME "@rx /remote\.php/dav/comments/files(?:/[0-9]+)+$" \
    "id:9508132,\
    phase:1,\
    pass,\
    t:none,\
    nolog,\
    ver:'nextcloud-rule-exclusions-plugin/1.5.0',\
    ctl:ruleRemoveTargetById=920272;ARGS:creationDateTime,\
    ctl:ruleRemoveTargetById=920273;ARGS:creationDateTime,\
    ctl:ruleRemoveTargetById=942432;ARGS:creationDateTime,\
    ctl:ruleRemoveTargetById=920272;ARGS:json.creationDateTime,\
    ctl:ruleRemoveTargetById=920273;ARGS:json.creationDateTime,\
    ctl:ruleRemoveTargetById=942432;ARGS:json.creationDateTime,\
    ctl:ruleRemoveTargetById=920272;REQUEST_BODY,\
    ctl:ruleRemoveTargetById=920273;REQUEST_BODY,\
    ctl:ruleRemoveTargetById=921110;REQUEST_BODY,\
    ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:message,\
    ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:json.message"
SecRule REQUEST_FILENAME "@rx /remote\.php/dav/trashbin/[^/]+/trash/" \
    "id:9508133,\
    phase:1,\
    pass,\
    t:none,\
    nolog,\
    ver:'nextcloud-rule-exclusions-plugin/1.5.0',\
    ctl:ruleRemoveTargetById=920272;REQUEST_BODY,\
    ctl:ruleRemoveTargetById=920273;REQUEST_BODY,\
    ctl:ruleRemoveTargetById=921110;REQUEST_BODY"
SecRule REQUEST_FILENAME "@rx (?i)/s/[^/]+/authenticate/showshare$" \
    "id:9508134,\
    phase:1,\
    pass,\
    t:none,\
    nolog,\
    ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:password,\
    ver:'nextcloud-rule-exclusions-plugin/1.5.0'"
SecRule REQUEST_FILENAME "@rx /ocs/v[0-9.]+\.php/apps/files_sharing/api/v[0-9.]+/shares(?:/[0-9]+)?$" \
    "id:9508135,\
    phase:1,\
    pass,\
    t:none,\
    nolog,\
    ctl:ruleRemoveTargetById=920273;ARGS:attributes,\
    ctl:ruleRemoveTargetById=932240;ARGS:attributes,\
    ctl:ruleRemoveTargetById=942200;ARGS:attributes,\
    ctl:ruleRemoveTargetById=942340;ARGS:attributes,\
    ctl:ruleRemoveTargetById=942370;ARGS:attributes,\
    ctl:ruleRemoveTargetById=942430;ARGS:attributes,\
    ctl:ruleRemoveTargetById=942431;ARGS:attributes,\
    ctl:ruleRemoveTargetById=942432;ARGS:attributes,\
    ctl:ruleRemoveTargetById=920273;ARGS:expireDate,\
    ctl:ruleRemoveTargetById=942432;ARGS:expireDate,\
    ctl:ruleRemoveTargetById=920273;ARGS:json.attributes,\
    ctl:ruleRemoveTargetById=932240;ARGS:json.attributes,\
    ctl:ruleRemoveTargetById=942200;ARGS:json.attributes,\
    ctl:ruleRemoveTargetById=942340;ARGS:json.attributes,\
    ctl:ruleRemoveTargetById=942370;ARGS:json.attributes,\
    ctl:ruleRemoveTargetById=942430;ARGS:json.attributes,\
    ctl:ruleRemoveTargetById=942431;ARGS:json.attributes,\
    ctl:ruleRemoveTargetById=942432;ARGS:json.attributes,\
    ctl:ruleRemoveTargetById=920273;ARGS:json.expireDate,\
    ctl:ruleRemoveTargetById=942432;ARGS:json.expireDate,\
    ctl:ruleRemoveTargetById=920273;ARGS:json.path,\
    ctl:ruleRemoveTargetById=930120;ARGS:json.path,\
    ctl:ruleRemoveTargetById=920273;ARGS:json.shareWith,\
    ctl:ruleRemoveTargetById=920273;ARGS:path,\
    ctl:ruleRemoveTargetById=930120;ARGS:path,\
    ctl:ruleRemoveTargetById=920273;ARGS:shareWith,\
    ctl:ruleRemoveTargetById=920273;REQUEST_BODY,\
    ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:password,\
    ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:json.password,\
    ver:'nextcloud-rule-exclusions-plugin/1.5.0'"
SecRule REQUEST_FILENAME "@rx /public\.php/dav/files/[^/]+/$" \
    "id:9508136,\
    phase:1,\
    pass,\
    t:none,\
    nolog,\
    ver:'nextcloud-rule-exclusions-plugin/1.5.0',\
    chain"
    SecRule ARGS:accept "@streq zip" \
        "t:none,\
        ctl:ruleRemoveTargetById=932236;ARGS:accept"
SecRule REQUEST_FILENAME "@rx /ocs/v[0-9.]+\.php/apps/files_sharing/api/v[0-9.]+/shares/[0-9]+/send-email$" \
    "id:9508137,\
    phase:1,\
    pass,\
    t:none,\
    nolog,\
    ver:'nextcloud-rule-exclusions-plugin/1.5.0',\
    ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:json.password,\
    ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:password"
SecRule REQUEST_FILENAME "@rx /remote\.php/dav/comments/files(?:/[0-9]+)+$" \
    "id:9508138,\
    phase:1,\
    pass,\
    t:none,\
    nolog,\
    ver:'nextcloud-rule-exclusions-plugin/1.5.0',\
    ctl:ruleRemoveTargetById=941160;XML:/*,\
    ctl:ruleRemoveTargetById=941160;XML"
SecRule REQUEST_FILENAME "@rx /remote.php/dav/comments/files/[0-9]+$" \
    "id:9508139,\
    phase:1,\
    pass,\
    t:none,\
    nolog,\
    ver:'nextcloud-rule-exclusions-plugin/1.5.0',\
    chain"
    SecRule &REQUEST_HEADERS:Content-Type "@eq 0" \
        "t:none,\
        chain"
        SecRule REQUEST_HEADERS:User-Agent "@contains Nextcloud-iOS" \
            "t:none,\
            chain"
            SecRule REQUEST_METHOD "@streq PROPFIND" \
                "t:none,\
                ctl:ruleRemoveById=920340,\
                ctl:ruleRemoveById=920341,\
                ctl:requestBodyProcessor=XML"
SecRule REQUEST_FILENAME "@rx /ocs/v[0-9.]+\.php/search/providers(?:/[^/]+/search)?$" \
    "id:9508171,\
    phase:1,\
    pass,\
    t:none,\
    nolog,\
    ver:'nextcloud-rule-exclusions-plugin/1.5.0',\
    ctl:ruleRemoveTargetById=920230;ARGS:from,\
    ctl:ruleRemoveTargetById=932190;ARGS:from,\
    ctl:ruleRemoveTargetById=932200;ARGS:from,\
    ctl:ruleRemoveTargetById=942200;ARGS:from,\
    ctl:ruleRemoveTargetById=942210;ARGS:from,\
    ctl:ruleRemoveTargetById=942430;ARGS:from,\
    ctl:ruleRemoveTargetById=942440;ARGS:from"
SecRule REQUEST_FILENAME "@rx /(?:remote\.php|index\.php/|public\.php/|apps/|ocs/|\.well-known/|settings/|avatar$)" \
    "id:9508190,\
    phase:1,\
    pass,\
    t:none,\
    nolog,\
    ver:'nextcloud-rule-exclusions-plugin/1.5.0',\
    setvar:'tx.allowed_methods=%{tx.allowed_methods} PUT PATCH CHECKOUT COPY DELETE LOCK MERGE MKACTIVITY MKCALENDAR MKCOL MOVE PROPFIND PROPPATCH SEARCH UNLOCK REPORT TRACE jsonp'"
SecRule REQUEST_FILENAME "@streq /" \
    "id:9508191,\
    phase:1,\
    pass,\
    t:none,\
    nolog,\
    ver:'nextcloud-rule-exclusions-plugin/1.5.0',\
    ctl:ruleRemoveTargetById=921110;REQUEST_BODY,\
    setvar:'tx.allowed_methods=%{tx.allowed_methods} PUT PROPFIND'"
SecRule REQUEST_FILENAME "@rx /(?:remote|public)\.php/dav/" \
    "id:9508192,\
    phase:2,\
    pass,\
    t:none,\
    nolog,\
    ver:'nextcloud-rule-exclusions-plugin/1.5.0',\
    chain"
    SecRule REQUEST_HEADERS:Content-Type "@rx ^(?:text/plain|text/xml|application/xml)" \
        "t:none,\
        chain"
        SecRule REQUEST_BODY_LENGTH "@eq 0" \
            "t:none,\
            ctl:ruleRemoveById=200002"
SecRule REQUEST_FILENAME "@rx /(?:remote|public)\.php" \
    "id:9508193,\
    phase:1,\
    pass,\
    t:none,\
    nolog,\
    ver:'nextcloud-rule-exclusions-plugin/1.5.0',\
    chain"
    SecRule REQUEST_HEADERS:Content-Type "@beginsWith text/plain" \
        "t:none,\
        ctl:requestBodyProcessor=XML,\
        setvar:'tx.allowed_request_content_type=%{tx.allowed_request_content_type} |text/plain|'"
SecRule REQUEST_FILENAME "@rx /apps/bookmarks/(?:bookmark(?:/[0-9]+|/click)?|public/rest/v[0-9.]+/bookmark(?:/[0-9]+)?)$" \
    "id:9508210,\
    phase:1,\
    pass,\
    t:none,\
    nolog,\
    ver:'nextcloud-rule-exclusions-plugin/1.5.0',\
    ctl:ruleRemoveTargetById=920273;ARGS:json.target,\
    ctl:ruleRemoveTargetById=931130;ARGS:json.target,\
    ctl:ruleRemoveTargetById=932200;ARGS:json.target,\
    ctl:ruleRemoveTargetById=932240;ARGS:json.target,\
    ctl:ruleRemoveTargetById=941170;ARGS:json.target,\
    ctl:ruleRemoveTargetById=941210;ARGS:json.target,\
    ctl:ruleRemoveTargetById=942430;ARGS:json.target,\
    ctl:ruleRemoveTargetById=942431;ARGS:json.target,\
    ctl:ruleRemoveTargetById=942432;ARGS:json.target,\
    ctl:ruleRemoveTargetById=920272;ARGS:json.title,\
    ctl:ruleRemoveTargetById=920273;ARGS:json.title,\
    ctl:ruleRemoveTargetById=931130;ARGS:json.title,\
    ctl:ruleRemoveTargetById=932200;ARGS:json.title,\
    ctl:ruleRemoveTargetById=932220;ARGS:json.title,\
    ctl:ruleRemoveTargetById=932236;ARGS:json.title,\
    ctl:ruleRemoveTargetById=932240;ARGS:json.title,\
    ctl:ruleRemoveTargetById=932260;ARGS:json.title,\
    ctl:ruleRemoveTargetById=942431;ARGS:json.title,\
    ctl:ruleRemoveTargetById=942432;ARGS:json.title,\
    ctl:ruleRemoveTargetById=942440;ARGS:json.title,\
    ctl:ruleRemoveTargetById=942460;ARGS:json.title,\
    ctl:ruleRemoveTargetById=920273;ARGS:json.url,\
    ctl:ruleRemoveTargetById=931130;ARGS:json.url,\
    ctl:ruleRemoveTargetById=932200;ARGS:json.url,\
    ctl:ruleRemoveTargetById=932240;ARGS:json.url,\
    ctl:ruleRemoveTargetById=941170;ARGS:json.url,\
    ctl:ruleRemoveTargetById=941210;ARGS:json.url,\
    ctl:ruleRemoveTargetById=942430;ARGS:json.url,\
    ctl:ruleRemoveTargetById=942431;ARGS:json.url,\
    ctl:ruleRemoveTargetById=942432;ARGS:json.url,\
    ctl:ruleRemoveTargetById=920273;ARGS:target,\
    ctl:ruleRemoveTargetById=931130;ARGS:target,\
    ctl:ruleRemoveTargetById=932200;ARGS:target,\
    ctl:ruleRemoveTargetById=932240;ARGS:target,\
    ctl:ruleRemoveTargetById=941170;ARGS:target,\
    ctl:ruleRemoveTargetById=941210;ARGS:target,\
    ctl:ruleRemoveTargetById=942430;ARGS:target,\
    ctl:ruleRemoveTargetById=942431;ARGS:target,\
    ctl:ruleRemoveTargetById=942432;ARGS:target,\
    ctl:ruleRemoveTargetById=920272;ARGS:title,\
    ctl:ruleRemoveTargetById=920273;ARGS:title,\
    ctl:ruleRemoveTargetById=931130;ARGS:title,\
    ctl:ruleRemoveTargetById=932200;ARGS:title,\
    ctl:ruleRemoveTargetById=932220;ARGS:title,\
    ctl:ruleRemoveTargetById=932236;ARGS:title,\
    ctl:ruleRemoveTargetById=932240;ARGS:title,\
    ctl:ruleRemoveTargetById=932260;ARGS:title,\
    ctl:ruleRemoveTargetById=942431;ARGS:title,\
    ctl:ruleRemoveTargetById=942432;ARGS:title,\
    ctl:ruleRemoveTargetById=942440;ARGS:title,\
    ctl:ruleRemoveTargetById=942460;ARGS:title,\
    ctl:ruleRemoveTargetById=920273;ARGS:url,\
    ctl:ruleRemoveTargetById=931130;ARGS:url,\
    ctl:ruleRemoveTargetById=932200;ARGS:url,\
    ctl:ruleRemoveTargetById=932240;ARGS:url,\
    ctl:ruleRemoveTargetById=941170;ARGS:url,\
    ctl:ruleRemoveTargetById=941210;ARGS:url,\
    ctl:ruleRemoveTargetById=942430;ARGS:url,\
    ctl:ruleRemoveTargetById=942431;ARGS:url,\
    ctl:ruleRemoveTargetById=942432;ARGS:url,\
    ctl:ruleRemoveTargetById=920273;REQUEST_BODY,\
    ctl:ruleRemoveTargetById=921180;TX:paramcounter_ARGS_NAMES:folders.folders"
SecRule REQUEST_FILENAME "@rx /ocs/v[0-9.]\.php/apps/external/api/v[0-9.]+/sites(?:/[0-9]+)?$" \
    "id:9508240,\
    phase:1,\
    pass,\
    t:none,\
    nolog,\
    ver:'nextcloud-rule-exclusions-plugin/1.5.0',\
    ctl:ruleRemoveTargetById=920273;ARGS:json.url,\
    ctl:ruleRemoveTargetById=931130;ARGS:json.url,\
    ctl:ruleRemoveTargetById=942432;ARGS:json.url,\
    ctl:ruleRemoveTargetById=920273;ARGS:url,\
    ctl:ruleRemoveTargetById=931130;ARGS:url,\
    ctl:ruleRemoveTargetById=942432;ARGS:url,\
    ctl:ruleRemoveTargetById=920273;REQUEST_BODY"
SecRule REQUEST_FILENAME "@rx /apps/text/(?:public/)?(?:session/(?:[0-9]+/)?(?:sync|close|push|save)|attachments)$" \
    "id:9508311,\
    phase:1,\
    pass,\
    t:none,\
    nolog,\
    ver:'nextcloud-rule-exclusions-plugin/1.5.0',\
    ctl:ruleRemoveById=943120,\
    ctl:ruleRemoveTargetById=920273;ARGS,\
    ctl:ruleRemoveTargetById=932236;ARGS,\
    ctl:ruleRemoveTargetById=932250;ARGS,\
    ctl:ruleRemoveTargetById=934101;ARGS,\
    ctl:ruleRemoveTargetById=941100;ARGS,\
    ctl:ruleRemoveTargetById=942120;ARGS,\
    ctl:ruleRemoveTargetById=942210;ARGS,\
    ctl:ruleRemoveTargetById=942390;ARGS,\
    ctl:ruleRemoveTargetById=942432;ARGS,\
    ctl:ruleRemoveTargetById=942450;ARGS,\
    ctl:ruleRemoveTargetById=920272;REQUEST_BODY,\
    ctl:ruleRemoveTargetById=920273;REQUEST_BODY,\
    ctl:ruleRemoveTargetById=921110;REQUEST_BODY"
SecRule REQUEST_FILENAME "@rx /apps/text/(?:public/)?session(?:/[0-9]+)?/(?:sync|save)$" \
    "id:9508313,\
    phase:1,\
    pass,\
    t:none,\
    nolog,\
    ver:'nextcloud-rule-exclusions-plugin/1.5.0',\
    ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:autosaveContent,\
    ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:json.autosaveContent"
SecRule REQUEST_FILENAME "@rx /apps/text/(?:public/)?session/push$" \
    "id:9508314,\
    phase:1,\
    pass,\
    t:none,\
    nolog,\
    ver:'nextcloud-rule-exclusions-plugin/1.5.0',\
    ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS"
SecRule REQUEST_FILENAME "@rx /remote\.php/dav/addressbooks/users/(?:[^/]+/){1,2}(?:[^/]+)?$" \
    "id:9508320,\
    phase:1,\
    pass,\
    t:none,\
    nolog,\
    ver:'nextcloud-rule-exclusions-plugin/1.5.0',\
    ctl:ruleRemoveById=920530,\
    ctl:ruleRemoveTargetById=921110;REQUEST_BODY,\
    ctl:ruleRemoveTargetById=942430;XML,\
    ctl:ruleRemoveTargetById=942431;XML,\
    ctl:ruleRemoveTargetById=942432;XML,\
    ctl:ruleRemoveTargetById=942440;XML,\
    ctl:ruleRemoveTargetById=942430;XML:/*,\
    ctl:ruleRemoveTargetById=942431;XML:/*,\
    ctl:ruleRemoveTargetById=942432;XML:/*,\
    ctl:ruleRemoveTargetById=942440;XML:/*,\
    setvar:'tx.allowed_request_content_type=%{tx.allowed_request_content_type} |text/vcard|'"
SecRule REQUEST_FILENAME "@rx /remote\.php/dav/addressbooks/users/(?:[^/]+/){2}[0-9]+$" \
    "id:9508323,\
    phase:3,\
    pass,\
    t:none,\
    nolog,\
    ver:'nextcloud-rule-exclusions-plugin/1.5.0',\
    chain"
    SecRule RESPONSE_STATUS "@streq 501" \
        "t:none,\
        ctl:ruleRemoveById=950100"
SecRule REQUEST_FILENAME "@rx /remote\.php/(?:cal)?dav/calendars/[^/]+/[^/]+(?:/|/[^/]+\.ics)?$" \
    "id:9508330,\
    phase:1,\
    pass,\
    t:none,\
    nolog,\
    ver:'nextcloud-rule-exclusions-plugin/1.5.0',\
    ctl:ruleRemoveTargetById=920272;REQUEST_BODY,\
    ctl:ruleRemoveTargetById=920273;REQUEST_BODY,\
    ctl:ruleRemoveTargetById=942430;XML,\
    ctl:ruleRemoveTargetById=942431;XML,\
    ctl:ruleRemoveTargetById=942432;XML,\
    ctl:ruleRemoveTargetById=942440;XML,\
    ctl:ruleRemoveTargetById=942430;XML:/*,\
    ctl:ruleRemoveTargetById=942431;XML:/*,\
    ctl:ruleRemoveTargetById=942432;XML:/*,\
    ctl:ruleRemoveTargetById=942440;XML:/*,\
    setvar:'tx.allowed_request_content_type=%{tx.allowed_request_content_type} |text/calendar|'"
SecRule REQUEST_FILENAME "@rx /remote\.php/dav/calendars/(?:[^/]+/){2}[^/]+\.ics$" \
    "id:9508333,\
    phase:3,\
    pass,\
    t:none,\
    nolog,\
    ver:'nextcloud-rule-exclusions-plugin/1.5.0',\
    chain"
    SecRule RESPONSE_STATUS "@streq 500" \
        "t:none,\
        ctl:ruleRemoveById=950100"
SecRule REQUEST_FILENAME "@rx /apps/calendar/v[0-9.]+/appointment_configs(?:/[0-9]+)?$" \
    "id:9508334,\
    phase:1,\
    pass,\
    t:none,\
    nolog,\
    ver:'nextcloud-rule-exclusions-plugin/1.5.0',\
    ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:description,\
    ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:json.description"
SecRule REQUEST_FILENAME "@rx /remote\.php/dav/calendars/(?:[^/]+/){2}[^/]+\.ics$" \
    "id:9508338,\
    phase:1,\
    pass,\
    t:none,\
    nolog,\
    ver:'nextcloud-rule-exclusions-plugin/1.5.0',\
    ctl:ruleRemoveById=920530"
SecRule REQUEST_FILENAME "@rx /login(?:/confirm)?$" \
    "id:9508400,\
    phase:1,\
    pass,\
    t:none,\
    nolog,\
    ver:'nextcloud-rule-exclusions-plugin/1.5.0',\
    ctl:ruleRemoveTargetById=920272;REQUEST_BODY,\
    ctl:ruleRemoveTargetById=920273;REQUEST_BODY,\
    ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:password,\
    ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:json.password"
SecRule REQUEST_FILENAME "@endsWith /login/webauthn/finish" \
    "id:9508402,\
    phase:1,\
    pass,\
    t:none,\
    nolog,\
    ver:'nextcloud-rule-exclusions-plugin/1.5.0',\
    ctl:ruleRemoveTargetById=920273;ARGS:data,\
    ctl:ruleRemoveTargetById=932236;ARGS:data,\
    ctl:ruleRemoveTargetById=932240;ARGS:data,\
    ctl:ruleRemoveTargetById=920273;ARGS:json.data,\
    ctl:ruleRemoveTargetById=932236;ARGS:json.data,\
    ctl:ruleRemoveTargetById=932240;ARGS:json.data,\
    ctl:ruleRemoveTargetById=920272;REQUEST_BODY,\
    ctl:ruleRemoveTargetById=920273;REQUEST_BODY,\
    ctl:ruleRemoveTargetByTag=attack-sqli;ARGS:data,\
    ctl:ruleRemoveTargetByTag=attack-sqli;ARGS:json.data"
SecRule REQUEST_FILENAME "@rx /login/v[0-9.]+/grant$" \
    "id:9508403,\
    phase:2,\
    pass,\
    t:none,\
    nolog,\
    ver:'nextcloud-rule-exclusions-plugin/1.5.0',\
    ctl:ruleRemoveTargetById=932236;ARGS:stateToken,\
    ctl:ruleRemoveTargetById=942450;ARGS:stateToken"
SecRule REQUEST_FILENAME "@rx /lostpassword/set/[^/]+/[^/]+$" \
    "id:9508411,\
    phase:1,\
    pass,\
    t:none,\
    nolog,\
    ver:'nextcloud-rule-exclusions-plugin/1.5.0',\
    ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:password,\
    ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:json.password"
SecRule REQUEST_FILENAME "@endsWith /login/webauthn/finish" \
    "id:9508421,\
    phase:3,\
    pass,\
    t:none,\
    nolog,\
    ver:'nextcloud-rule-exclusions-plugin/1.5.0',\
    chain"
    SecRule RESPONSE_STATUS "@streq 500" \
        "t:none,\
        ctl:ruleRemoveById=950100"
SecRule REQUEST_FILENAME "@rx /ocs/v[0-9.]+\.php/cloud/users(?:/[^/]+)?$" \
    "id:9508501,\
    phase:1,\
    pass,\
    t:none,\
    nolog,\
    ver:'nextcloud-rule-exclusions-plugin/1.5.0',\
    ctl:ruleRemoveTargetById=920273;REQUEST_BODY,\
    ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:password,\
    ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:value,\
    ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:json.password,\
    ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:json.value"
SecRule REQUEST_FILENAME "@rx /login(?:/selectchallenge|/challenge/[^/]+)?$" \
    "id:9508502,\
    phase:1,\
    pass,\
    t:none,\
    nolog,\
    ver:'nextcloud-rule-exclusions-plugin/1.5.0',\
    ctl:ruleRemoveTargetById=920230;ARGS:redirect_url,\
    ctl:ruleRemoveTargetById=932200;ARGS:redirect_url,\
    ctl:ruleRemoveTargetById=932190;ARGS:redirect_url,\
    ctl:ruleRemoveTargetById=942431;ARGS:redirect_url,\
    ctl:ruleRemoveTargetById=942432;ARGS:redirect_url"
SecRule REQUEST_FILENAME "@unconditionalMatch" \
    "id:9508510,\
    phase:1,\
    pass,\
    t:none,\
    nolog,\
    ver:'nextcloud-rule-exclusions-plugin/1.5.0',\
    ctl:ruleRemoveTargetById=920273;ARGS:requesttoken,\
    ctl:ruleRemoveTargetById=932236;ARGS:requesttoken,\
    ctl:ruleRemoveTargetById=941100;ARGS:requesttoken,\
    ctl:ruleRemoveTargetById=941120;ARGS:requesttoken,\
    ctl:ruleRemoveTargetById=942390;ARGS:requesttoken,\
    ctl:ruleRemoveTargetById=942432;ARGS:requesttoken,\
    ctl:ruleRemoveTargetById=942450;ARGS:requesttoken,\
    ctl:ruleRemoveTargetById=920273;ARGS:timezone,\
    ctl:ruleRemoveTargetById=942450;REQUEST_COOKIES,\
    ctl:ruleRemoveTargetById=932236;REQUEST_COOKIES:nc_session_id,\
    ctl:ruleRemoveTargetById=942450;REQUEST_COOKIES:nc_session_id,\
    ctl:ruleRemoveTargetById=932236;REQUEST_COOKIES:nc_token,\
    ctl:ruleRemoveTargetById=942450;REQUEST_COOKIES:nc_token,\
    ctl:ruleRemoveTargetById=932236;REQUEST_COOKIES:oc_sessionPassphrase,\
    ctl:ruleRemoveTargetById=942210;REQUEST_COOKIES:oc_sessionPassphrase,\
    ctl:ruleRemoveTargetById=942450;REQUEST_COOKIES:oc_sessionPassphrase"
SecRule REQUEST_FILENAME "@rx (?i)\.(?:avif|bmp|brotli|bvr|css|eot|gif|gz|ico|jpeg|jpg|map|m?js|mp[34]|otf|png|svg|swf|ts|ttf|txt|wav|webp|woff2?)$" \
    "id:9508511,\
    phase:1,\
    pass,\
    t:none,\
    nolog,\
    ver:'nextcloud-rule-exclusions-plugin/1.5.0',\
    ctl:ruleRemoveTargetById=932236;ARGS:v"
SecRule REQUEST_FILENAME "@rx /(?:public|remote)\.php/dav/(?:bulk|files/|uploads/)" \
    "id:9508512,\
    phase:1,\
    pass,\
    t:none,\
    nolog,\
    ver:'nextcloud-rule-exclusions-plugin/1.5.0',\
    ctl:ruleRemoveById=200002"
SecRule REQUEST_FILENAME "@rx /push//?ws$" \
    "id:9508513,\
    phase:1,\
    pass,\
    t:none,\
    nolog,\
    ver:'nextcloud-rule-exclusions-plugin/1.5.0',\
    ctl:ruleRemoveById=920320"
SecRule ARGS:install "@streq true" \
    "id:9508520,\
    phase:2,\
    pass,\
    t:none,\
    nolog,\
    ver:'nextcloud-rule-exclusions-plugin/1.5.0',\
    chain"
    SecRule ARGS:dbtype "@rx ^(?:mysql|pgsql|sqlite)$" \
        "t:none,\
        ctl:ruleRemoveTargetById=932260;ARGS:dbtype,\
        ctl:ruleRemoveTargetById=932236;ARGS:dbtype,\
        ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:adminpass,\
        ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:dbpass,\
        ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:dbpass-clone"
SecRule REQUEST_FILENAME "@rx /index\.php/apps/richdocuments/wopi/files/[^/]+(?:/contents)?$" \
    "id:9508530,\
    phase:1,\
    pass,\
    t:none,\
    nolog,\
    ver:'nextcloud-rule-exclusions-plugin/1.5.0',\
    ctl:ruleRemoveTargetById=932236;ARGS:access_token,\
    ctl:ruleRemoveTargetById=942450;ARGS:access_token,\
    ctl:ruleRemoveTargetById=920272;REQUEST_BODY,\
    ctl:ruleRemoveTargetById=920273;REQUEST_BODY,\
    setvar:'tx.allowed_request_content_type=%{tx.allowed_request_content_type} |application/octet-stream|'"
SecRule REQUEST_FILENAME "@rx /apps/richdocuments/direct/[^/]+$" \
    "id:9508533,\
    phase:4,\
    pass,\
    t:none,\
    nolog,\
    ver:'nextcloud-rule-exclusions-plugin/1.5.0',\
    chain"
    SecRule REQUEST_METHOD "@streq GET" \
        "t:none,\
        chain"
        SecRule RESPONSE_BODY "@contains failed to open the requested file." \
            "t:none,\
            t:lowercase,\
            ctl:ruleRemoveById=953100"
SecRule REQUEST_FILENAME "@rx /(?:settings/admin/richdocuments|browser/[^/]+/admin/adminIntegratorSettings\.html)$" \
    "id:9508656,\
    phase:1,\
    pass,\
    t:none,\
    nolog,\
    ver:'nextcloud-rule-exclusions-plugin/1.5.0',\
    ctl:ruleRemoveTargetById=920273;ARGS:css_variables,\
    ctl:ruleRemoveTargetById=942430;ARGS:css_variables,\
    ctl:ruleRemoveTargetById=942431;ARGS:css_variables,\
    ctl:ruleRemoveTargetById=942432;ARGS:css_variables,\
    ctl:ruleRemoveTargetById=942440;ARGS:css_variables,\
    ctl:ruleRemoveTargetById=942460;ARGS:css_variables,\
    ctl:ruleRemoveTargetById=920273;ARGS:wopi_setting_base_url,\
    ctl:ruleRemoveTargetById=920273;REQUEST_BODY"
SecRule REQUEST_FILENAME "@endsWith /apps/richdocumentscode/proxy.php" \
    "id:9508540,\
    phase:1,\
    pass,\
    t:none,\
    nolog,\
    ver:'nextcloud-rule-exclusions-plugin/1.5.0',\
    ctl:ruleRemoveTargetById=920273;ARGS:compat,\
    ctl:ruleRemoveTargetById=920273;ARGS:req,\
    setvar:'tx.allowed_request_content_type=%{tx.allowed_request_content_type} |text/plain|'"
SecRule REQUEST_FILENAME "@endsWith /apps/richdocumentscode/proxy.php" \
    "id:9508541,\
    phase:1,\
    pass,\
    t:none,\
    nolog,\
    ver:'nextcloud-rule-exclusions-plugin/1.5.0',\
    ctl:ruleRemoveTargetById=931130;ARGS:buy_product,\
    ctl:ruleRemoveTargetById=920272;ARGS:css_variables,\
    ctl:ruleRemoveTargetById=920273;ARGS:css_variables,\
    ctl:ruleRemoveTargetById=942422;ARGS:css_variables,\
    ctl:ruleRemoveTargetById=942430;ARGS:css_variables,\
    ctl:ruleRemoveTargetById=942431;ARGS:css_variables,\
    ctl:ruleRemoveTargetById=942432;ARGS:css_variables,\
    ctl:ruleRemoveTargetById=942440;ARGS:css_variables,\
    ctl:ruleRemoveTargetById=942460;ARGS:css_variables,\
    ctl:ruleRemoveTargetById=932236;ARGS:req,\
    ctl:ruleRemoveTargetById=932190;ARGS:req,\
    ctl:ruleRemoveTargetById=942431;ARGS:req,\
    ctl:ruleRemoveTargetById=942432;ARGS:req,\
    ctl:ruleRemoveTargetById=942430;ARGS:ui_defaults,\
    ctl:ruleRemoveTargetById=942431;ARGS:ui_defaults,\
    ctl:ruleRemoveTargetById=942432;ARGS:ui_defaults,\
    ctl:ruleRemoveTargetById=920272;REQUEST_BODY,\
    ctl:ruleRemoveTargetById=920273;REQUEST_BODY,\
    ctl:ruleRemoveTargetById=921110;REQUEST_BODY"
SecRule REQUEST_FILENAME "@rx /browser/[^/]+/cool\.html$" \
    "id:9508550,\
    phase:1,\
    pass,\
    t:none,\
    nolog,\
    ver:'nextcloud-rule-exclusions-plugin/1.5.0',\
    chain"
    SecRule REQUEST_HEADERS:Content-Type "@beginsWith text/plain" \
        "t:none,\
        ctl:requestBodyProcessor=XML,\
        setvar:'tx.allowed_request_content_type=%{tx.allowed_request_content_type} |text/plain|'"
SecRule REQUEST_FILENAME "@rx /browser/[^/]+/cool\.html$" \
    "id:9508551,\
    phase:1,\
    pass,\
    t:none,\
    nolog,\
    ver:'nextcloud-rule-exclusions-plugin/1.5.0',\
    ctl:ruleRemoveTargetById=931130;ARGS:buy_product,\
    ctl:ruleRemoveTargetById=932236;ARGS:access_token,\
    ctl:ruleRemoveTargetById=942450;ARGS:access_token,\
    ctl:ruleRemoveTargetById=920272;ARGS:css_variables,\
    ctl:ruleRemoveTargetById=920273;ARGS:css_variables,\
    ctl:ruleRemoveTargetById=942422;ARGS:css_variables,\
    ctl:ruleRemoveTargetById=942430;ARGS:css_variables,\
    ctl:ruleRemoveTargetById=942431;ARGS:css_variables,\
    ctl:ruleRemoveTargetById=942432;ARGS:css_variables,\
    ctl:ruleRemoveTargetById=942440;ARGS:css_variables,\
    ctl:ruleRemoveTargetById=942460;ARGS:css_variables,\
    ctl:ruleRemoveTargetById=932236;ARGS:req,\
    ctl:ruleRemoveTargetById=932190;ARGS:req,\
    ctl:ruleRemoveTargetById=942431;ARGS:req,\
    ctl:ruleRemoveTargetById=942432;ARGS:req,\
    ctl:ruleRemoveTargetById=942430;ARGS:ui_defaults,\
    ctl:ruleRemoveTargetById=942431;ARGS:ui_defaults,\
    ctl:ruleRemoveTargetById=942432;ARGS:ui_defaults,\
    ctl:ruleRemoveTargetById=920272;REQUEST_BODY,\
    ctl:ruleRemoveTargetById=920273;REQUEST_BODY,\
    ctl:ruleRemoveTargetById=921110;REQUEST_BODY"
SecRule REQUEST_FILENAME "@endsWith /apps/richdocuments/wopi/settings/upload" \
    "id:9508552,\
    phase:1,\
    pass,\
    t:none,\
    nolog,\
    ver:'nextcloud-rule-exclusions-plugin/1.5.0',\
    chain"
    SecRule REQUEST_HEADERS:Content-Type "@beginsWith text/html" \
        "t:none,\
        chain"
        SecRule ARGS:fileid "@endsWith .json" \
            "t:none,\
            ctl:requestBodyProcessor=JSON,\
            setvar:'tx.allowed_request_content_type=%{tx.allowed_request_content_type} |text/html|'"
SecRule REQUEST_FILENAME "@endsWith /apps/richdocuments/wopi/settings/upload" \
    "id:9508553,\
    phase:1,\
    pass,\
    t:none,\
    nolog,\
    ver:'nextcloud-rule-exclusions-plugin/1.5.0',\
    chain"
    SecRule REQUEST_HEADERS:Content-Type "@beginsWith text/html" \
        "t:none,\
        chain"
        SecRule ARGS:fileid "@endsWith documentView.xcu" \
            "t:none,\
            ctl:requestBodyProcessor=XML,\
            setvar:'tx.allowed_request_content_type=%{tx.allowed_request_content_type} |text/html|'"
SecRule REQUEST_FILENAME "@rx /apps/richdocuments/settings/(?:system|user)config/" \
    "id:9508554,\
    phase:1,\
    pass,\
    t:none,\
    nolog,\
    ver:'nextcloud-rule-exclusions-plugin/1.5.0',\
    chain"
    SecRule REQUEST_HEADERS:Content-Type "@beginsWith text/plain" \
        "t:none,\
        chain"
        SecRule REQUEST_BODY_LENGTH "@eq 0" \
            "t:none,\
            setvar:'tx.allowed_request_content_type=%{tx.allowed_request_content_type} |text/plain|'"
SecRule REQUEST_FILENAME "@rx /browser(?:/[^/]+){3}\.json$" \
    "id:9508555,\
    phase:1,\
    pass,\
    t:none,\
    nolog,\
    ver:'nextcloud-rule-exclusions-plugin/1.5.0',\
    chain"
    SecRule REQUEST_METHOD "@streq GET" \
        "t:none,\
        ctl:ruleRemoveTargetById=953101;REQUEST_BODY"
SecRule REQUEST_FILENAME "@endsWith /settings/api/personal/webauthn/registration" \
    "id:9508609,\
    phase:1,\
    pass,\
    t:none,\
    nolog,\
    ver:'nextcloud-rule-exclusions-plugin/1.5.0',\
    ctl:ruleRemoveTargetById=920273;ARGS:data,\
    ctl:ruleRemoveTargetById=932236;ARGS:data,\
    ctl:ruleRemoveTargetById=932240;ARGS:data,\
    ctl:ruleRemoveTargetById=920273;ARGS:json.data,\
    ctl:ruleRemoveTargetById=932236;ARGS:json.data,\
    ctl:ruleRemoveTargetById=932240;ARGS:json.data,\
    ctl:ruleRemoveTargetById=920273;REQUEST_BODY,\
    ctl:ruleRemoveTargetByTag=attack-sqli;ARGS:data,\
    ctl:ruleRemoveTargetByTag=attack-sqli;ARGS:json.data"
SecRule REQUEST_FILENAME "@endsWith /settings/personal/changepassword" \
    "id:9508610,\
    phase:1,\
    pass,\
    t:none,\
    nolog,\
    ver:'nextcloud-rule-exclusions-plugin/1.5.0',\
    ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:oldpassword,\
    ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:newpassword,\
    ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:json.oldpassword,\
    ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:json.newpassword"
SecRule REQUEST_FILENAME "@rx /remote\.php/dav/calendars/[^/]+/inbox$" \
    "id:9508612,\
    phase:1,\
    pass,\
    t:none,\
    nolog,\
    ver:'nextcloud-rule-exclusions-plugin/1.5.0',\
    ctl:ruleRemoveTargetById=932236;XML:/*,\
    ctl:ruleRemoveTargetById=942430;XML:/*,\
    ctl:ruleRemoveTargetById=942431;XML:/*,\
    ctl:ruleRemoveTargetById=942432;XML:/*,\
    ctl:ruleRemoveTargetById=932236;XML,\
    ctl:ruleRemoveTargetById=942430;XML,\
    ctl:ruleRemoveTargetById=942431;XML,\
    ctl:ruleRemoveTargetById=942432;XML"
SecRule REQUEST_FILENAME "@rx /ocs/v[0-9.]+\.php/apps/provisioning_api/api/v[0-9.]+/config/users/core/apporder$" \
    "id:9508614,\
    phase:1,\
    pass,\
    t:none,\
    nolog,\
    ver:'nextcloud-rule-exclusions-plugin/1.5.0',\
    ctl:ruleRemoveTargetById=932240;ARGS:configValue,\
    ctl:ruleRemoveTargetById=942200;ARGS:configValue,\
    ctl:ruleRemoveTargetById=942430;ARGS:configValue,\
    ctl:ruleRemoveTargetById=942431;ARGS:configValue,\
    ctl:ruleRemoveTargetById=942432;ARGS:configValue,\
    ctl:ruleRemoveTargetById=942340;ARGS:configValue,\
    ctl:ruleRemoveTargetById=942370;ARGS:configValue,\
    ctl:ruleRemoveTargetById=932240;ARGS:json.configValue,\
    ctl:ruleRemoveTargetById=942200;ARGS:json.configValue,\
    ctl:ruleRemoveTargetById=942430;ARGS:json.configValue,\
    ctl:ruleRemoveTargetById=942431;ARGS:json.configValue,\
    ctl:ruleRemoveTargetById=942432;ARGS:json.configValue,\
    ctl:ruleRemoveTargetById=942340;ARGS:json.configValue,\
    ctl:ruleRemoveTargetById=942370;ARGS:json.configValue"
SecRule REQUEST_FILENAME "@rx /ocs/v[0-9.]+\.php/apps/password_policy/api/v[0-9.]+/validate$" \
    "id:9508615,\
    phase:1,\
    pass,\
    t:none,\
    nolog,\
    ver:'nextcloud-rule-exclusions-plugin/1.5.0',\
    ctl:ruleRemoveTargetById=920273;REQUEST_BODY,\
    ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:password,\
    ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:json.password"
SecRule REQUEST_FILENAME "@rx /ocs/v[0-9.]+\.php/cloud/users/$" \
    "id:9508618,\
    phase:1,\
    pass,\
    t:none,\
    nolog,\
    ver:'nextcloud-rule-exclusions-plugin/1.5.0',\
    ctl:ruleRemoveTargetById=931130;ARGS:value,\
    ctl:ruleRemoveTargetById=931130;ARGS:json.value"
SecRule REQUEST_FILENAME "@endsWith /apps/encryption/ajax/updatePrivateKeyPassword" \
    "id:9508619,\
    phase:1,\
    pass,\
    t:none,\
    nolog,\
    ver:'nextcloud-rule-exclusions-plugin/1.5.0',\
    ctl:ruleRemoveTargetById=920273;REQUEST_BODY,\
    ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:newPassword,\
    ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:oldPassword"
SecRule REQUEST_FILENAME "@rx /ocs/v[0-9.]+\.php/apps/provisioning_api/api/v[0-9.]+/config/apps/news/exploreUrl$" \
    "id:9508640,\
    phase:1,\
    pass,\
    t:none,\
    nolog,\
    ver:'nextcloud-rule-exclusions-plugin/1.5.0',\
    ctl:ruleRemoveTargetById=931130;ARGS:json.value,\
    ctl:ruleRemoveTargetById=931130;ARGS:value"
SecRule REQUEST_FILENAME "@rx /ocs/v[0-9.]+\.php/apps/provisioning_api/api/v[0-9.]+/config/apps/password_policy/passwordContexts$" \
    "id:9508641,\
    phase:1,\
    pass,\
    t:none,\
    nolog,\
    ver:'nextcloud-rule-exclusions-plugin/1.5.0',\
    ctl:ruleRemoveTargetById=920273;ARGS:value,\
    ctl:ruleRemoveTargetById=932240;ARGS:value,\
    ctl:ruleRemoveTargetById=942431;ARGS:value,\
    ctl:ruleRemoveTargetById=942432;ARGS:value,\
    ctl:ruleRemoveTargetById=920273;REQUEST_BODY"
SecRule REQUEST_FILENAME "@endsWith /browser/dist/admin/adminIntegratorSettings.html" \
    "id:9508642,\
    phase:1,\
    pass,\
    t:none,\
    nolog,\
    ver:'nextcloud-rule-exclusions-plugin/1.5.0',\
    ctl:ruleRemoveTargetById=920272;ARGS:css_variables,\
    ctl:ruleRemoveTargetById=920273;ARGS:css_variables,\
    ctl:ruleRemoveTargetById=942430;ARGS:css_variables,\
    ctl:ruleRemoveTargetById=942431;ARGS:css_variables,\
    ctl:ruleRemoveTargetById=942432;ARGS:css_variables,\
    ctl:ruleRemoveTargetById=942440;ARGS:css_variables,\
    ctl:ruleRemoveTargetById=942460;ARGS:css_variables,\
    ctl:ruleRemoveTargetById=920273;ARGS:iframe_type,\
    ctl:ruleRemoveTargetById=920273;ARGS:wopi_setting_base_url,\
    ctl:ruleRemoveTargetById=931130;ARGS:wopi_setting_base_url,\
    ctl:ruleRemoveTargetById=920272;REQUEST_BODY,\
    ctl:ruleRemoveTargetById=920273;REQUEST_BODY"
SecRule REQUEST_FILENAME "@rx /apps/bookmarks/admin/settings/previews\.(?:pageres.env|screenshotmachine.key)$" \
    "id:9508643,\
    phase:1,\
    pass,\
    t:none,\
    nolog,\
    ver:'nextcloud-rule-exclusions-plugin/1.5.0',\
    ctl:ruleRemoveById=920440,\
    ctl:ruleRemoveTargetById=930130;REQUEST_FILENAME,\
    ctl:ruleRemoveTargetById=920273;REQUEST_BODY"
SecRule REQUEST_FILENAME "@rx /apps/settings//?settings/authorizedgroups/saveSettings$" \
    "id:9508644,\
    phase:1,\
    pass,\
    t:none,\
    nolog,\
    ver:'nextcloud-rule-exclusions-plugin/1.5.0',\
    ctl:ruleRemoveTargetById=920273;ARGS:class,\
    ctl:ruleRemoveTargetById=932240;ARGS:class,\
    ctl:ruleRemoveTargetById=920273;ARGS:json.class,\
    ctl:ruleRemoveTargetById=932240;ARGS:json.class,\
    ctl:ruleRemoveTargetById=920273;REQUEST_BODY"
SecRule REQUEST_FILENAME "@endsWith /apps/dav/api/exampleEvent/event" \
    "id:9508645,\
    phase:1,\
    pass,\
    t:none,\
    nolog,\
    ver:'nextcloud-rule-exclusions-plugin/1.5.0',\
    ctl:ruleRemoveTargetById=920272;ARGS:ics,\
    ctl:ruleRemoveTargetById=920273;ARGS:ics,\
    ctl:ruleRemoveTargetById=932200;ARGS:ics,\
    ctl:ruleRemoveTargetById=932240;ARGS:ics,\
    ctl:ruleRemoveTargetById=942430;ARGS:ics,\
    ctl:ruleRemoveTargetById=942431;ARGS:ics,\
    ctl:ruleRemoveTargetById=942432;ARGS:ics,\
    ctl:ruleRemoveTargetById=942460;ARGS:ics,\
    ctl:ruleRemoveTargetById=920272;ARGS:json.ics,\
    ctl:ruleRemoveTargetById=920273;ARGS:json.ics,\
    ctl:ruleRemoveTargetById=932200;ARGS:json.ics,\
    ctl:ruleRemoveTargetById=932240;ARGS:json.ics,\
    ctl:ruleRemoveTargetById=942430;ARGS:json.ics,\
    ctl:ruleRemoveTargetById=942431;ARGS:json.ics,\
    ctl:ruleRemoveTargetById=942432;ARGS:json.ics,\
    ctl:ruleRemoveTargetById=942460;ARGS:json.ics,\
    ctl:ruleRemoveTargetById=920273;REQUEST_BODY"
SecRule REQUEST_FILENAME "@endsWith /settings/admin/mailsettings/credentials" \
    "id:9508646,\
    phase:1,\
    pass,\
    t:none,\
    nolog,\
    ver:'nextcloud-rule-exclusions-plugin/1.5.0',\
    ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:mail_smtppassword"
SecRule REQUEST_FILENAME "@endsWith /apps/dav/api/defaultcontact/contact" \
    "id:9508647,\
    phase:1,\
    pass,\
    t:none,\
    nolog,\
    ver:'nextcloud-rule-exclusions-plugin/1.5.0',\
    ctl:ruleRemoveTargetById=920272;ARGS:contactData,\
    ctl:ruleRemoveTargetById=920273;ARGS:contactData,\
    ctl:ruleRemoveTargetById=932125;ARGS:contactData,\
    ctl:ruleRemoveTargetById=932370;ARGS:contactData,\
    ctl:ruleRemoveTargetById=932232;ARGS:contactData,\
    ctl:ruleRemoveTargetById=932236;ARGS:contactData,\
    ctl:ruleRemoveTargetById=942430;ARGS:contactData,\
    ctl:ruleRemoveTargetById=942431;ARGS:contactData,\
    ctl:ruleRemoveTargetById=942432;ARGS:contactData,\
    ctl:ruleRemoveTargetById=942460;ARGS:contactData,\
    ctl:ruleRemoveTargetById=920272;ARGS:json.contactData,\
    ctl:ruleRemoveTargetById=920273;ARGS:json.contactData,\
    ctl:ruleRemoveTargetById=932125;ARGS:json.contactData,\
    ctl:ruleRemoveTargetById=932370;ARGS:json.contactData,\
    ctl:ruleRemoveTargetById=932232;ARGS:json.contactData,\
    ctl:ruleRemoveTargetById=932236;ARGS:json.contactData,\
    ctl:ruleRemoveTargetById=942430;ARGS:json.contactData,\
    ctl:ruleRemoveTargetById=942431;ARGS:json.contactData,\
    ctl:ruleRemoveTargetById=942432;ARGS:json.contactData,\
    ctl:ruleRemoveTargetById=942460;ARGS:json.contactData"
SecRule REQUEST_FILENAME "@endsWith /apps/theming/ajax/updateStylesheet" \
    "id:9508648,\
    phase:1,\
    pass,\
    t:none,\
    nolog,\
    ver:'nextcloud-rule-exclusions-plugin/1.5.0',\
    ctl:ruleRemoveTargetById=931130;ARGS:value,\
    ctl:ruleRemoveTargetById=931130;ARGS:json.value"
SecRule REQUEST_FILENAME "@contains /apps/recognize/admin/settings/" \
    "id:9508649,\
    phase:1,\
    pass,\
    t:none,\
    nolog,\
    ver:'nextcloud-rule-exclusions-plugin/1.5.0',\
    ctl:ruleRemoveTargetById=932160;ARGS:value,\
    ctl:ruleRemoveTargetById=932160;ARGS:json.value"
SecRule REQUEST_FILENAME "@endsWith /apps/logreader/api/settings" \
    "id:9508651,\
    phase:1,\
    pass,\
    t:none,\
    nolog,\
    ver:'nextcloud-rule-exclusions-plugin/1.5.0',\
    ctl:ruleRemoveTargetById=932236;ARGS:json.settingsValue,\
    ctl:ruleRemoveTargetById=932236;ARGS:settingsValue"
SecRule REQUEST_FILENAME "@rx /apps/logreader(?:/api)?/poll$" \
    "id:9508652,\
    phase:2,\
    pass,\
    t:none,\
    nolog,\
    ver:'nextcloud-rule-exclusions-plugin/1.5.0',\
    ctl:ruleRemoveTargetById=932236;ARGS:lastReqId,\
    ctl:ruleRemoveTargetById=942450;ARGS:lastReqId"
SecRule REQUEST_FILENAME "@endsWith /index.php/apps/richdocuments/ajax/admin.php" \
    "id:9508653,\
    phase:1,\
    pass,\
    t:none,\
    nolog,\
    ver:'nextcloud-rule-exclusions-plugin/1.5.0',\
    ctl:ruleRemoveTargetById=931130;ARGS:wopi_url,\
    ctl:ruleRemoveTargetById=931130;ARGS:json.wopi_url"
SecRule REQUEST_FILENAME "@rx /apps/oauth2/clients(?:/[0-9]+)?$" \
    "id:9508655,\
    phase:1,\
    pass,\
    t:none,\
    nolog,\
    ver:'nextcloud-rule-exclusions-plugin/1.5.0',\
    ctl:ruleRemoveTargetById=931130;ARGS:redirectUri,\
    ctl:ruleRemoveTargetById=932236;ARGS:name,\
    ctl:ruleRemoveTargetById=931130;ARGS:json.redirectUri,\
    ctl:ruleRemoveTargetById=932236;ARGS:json.name"
SecRule REQUEST_FILENAME "@endsWith /settings/api/apps/media" \
    "id:9508670,\
    phase:1,\
    pass,\
    t:none,\
    nolog,\
    ver:'nextcloud-rule-exclusions-plugin/1.5.0',\
    ctl:ruleRemoveTargetById=920273;ARGS:fileName,\
    ctl:ruleRemoveTargetById=931130;ARGS:fileName,\
    ctl:ruleRemoveTargetById=932190;ARGS:fileName,\
    ctl:ruleRemoveTargetById=942431;ARGS:fileName,\
    ctl:ruleRemoveTargetById=942432;ARGS:fileName"
SecRule REQUEST_FILENAME "@rx /ocs/v[0-9.]+\.php/apps/notifications/api/v[0-9.]+/notifications$" \
    "id:9508702,\
    phase:3,\
    pass,\
    t:none,\
    nolog,\
    ver:'nextcloud-rule-exclusions-plugin/1.5.0',\
    chain"
    SecRule RESPONSE_STATUS "@streq 502" \
        "t:none,\
        ctl:ruleRemoveById=950100"
SecRule REQUEST_FILENAME "@rx /ocs/v[0-9.]+\.php/apps/notifications/api/v[0-9.]+/push$" \
    "id:9508703,\
    phase:1,\
    pass,\
    t:none,\
    nolog,\
    ver:'nextcloud-rule-exclusions-plugin/1.5.0',\
    ctl:ruleRemoveTargetById=921151;ARGS_GET:devicePublicKey,\
    ctl:ruleRemoveTargetById=920272;ARGS:devicePublicKey,\
    ctl:ruleRemoveTargetById=920273;ARGS:devicePublicKey,\
    ctl:ruleRemoveTargetById=942430;ARGS:devicePublicKey,\
    ctl:ruleRemoveTargetById=942431;ARGS:devicePublicKey,\
    ctl:ruleRemoveTargetById=942432;ARGS:devicePublicKey,\
    ctl:ruleRemoveTargetById=942440;ARGS:devicePublicKey,\
    ctl:ruleRemoveTargetById=942460;ARGS:devicePublicKey,\
    ctl:ruleRemoveTargetById=920273;ARGS:proxyServer,\
    ctl:ruleRemoveTargetById=931130;ARGS:proxyServer,\
    ctl:ruleRemoveTargetById=920272;REQUEST_URI"
SecRule REQUEST_FILENAME "@rx /apps/cookbook/webapp/recipes(?:/[0-9]+)?$" \
    "id:9508720,\
    phase:1,\
    pass,\
    t:none,\
    nolog,\
    ver:'nextcloud-rule-exclusions-plugin/1.5.0',\
    ctl:ruleRemoveTargetById=920273;ARGS_NAMES,\
    ctl:ruleRemoveTargetById=932236;ARGS_NAMES:id,\
    ctl:ruleRemoveTargetById=920272;ARGS,\
    ctl:ruleRemoveTargetById=920273;ARGS,\
    ctl:ruleRemoveTargetById=931130;ARGS,\
    ctl:ruleRemoveTargetById=932190;ARGS,\
    ctl:ruleRemoveTargetById=932200;ARGS,\
    ctl:ruleRemoveTargetById=932236;ARGS,\
    ctl:ruleRemoveTargetById=932380;ARGS,\
    ctl:ruleRemoveTargetById=942200;ARGS,\
    ctl:ruleRemoveTargetById=942210;ARGS,\
    ctl:ruleRemoveTargetById=942430;ARGS,\
    ctl:ruleRemoveTargetById=942431;ARGS,\
    ctl:ruleRemoveTargetById=942432;ARGS,\
    ctl:ruleRemoveTargetById=942460;ARGS,\
    ctl:ruleRemoveTargetById=920272;REQUEST_BODY,\
    ctl:ruleRemoveTargetById=920273;REQUEST_BODY"
SecRule REQUEST_FILENAME "@endsWith /apps/cookbook/webapp/import" \
    "id:9508723,\
    phase:1,\
    pass,\
    t:none,\
    nolog,\
    ver:'nextcloud-rule-exclusions-plugin/1.5.0',\
    ctl:ruleRemoveTargetById=920273;ARGS:url,\
    ctl:ruleRemoveTargetById=931130;ARGS:url,\
    ctl:ruleRemoveTargetById=932190;ARGS:url,\
    ctl:ruleRemoveTargetById=942432;ARGS:url"
SecRule REQUEST_FILENAME "@rx /ocs/v[0-9.]+\.php/apps/files_sharing/api/v[0-9.]+/shares" \
    "id:9508800,\
    phase:1,\
    pass,\
    t:none,\
    nolog,\
    ver:'nextcloud-rule-exclusions-plugin/1.5.0',\
    chain"
    SecRule REQUEST_METHOD "@streq GET" \
        "t:none,\
        ctl:ruleRemoveById=200002"
SecRule REQUEST_FILENAME "@rx /apps/deck/cards(?:/[0-9]+(?:/reorder|/unassign)?)?$" \
    "id:9508810,\
    phase:1,\
    pass,\
    t:none,\
    nolog,\
    ver:'nextcloud-rule-exclusions-plugin/1.5.0',\
    ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:description,\
    ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:json.description"
SecRule REQUEST_FILENAME "@endsWith /apps/dashboard/statuses" \
    "id:9508830,\
    phase:1,\
    pass,\
    t:none,\
    nolog,\
    ver:'nextcloud-rule-exclusions-plugin/1.5.0',\
    ctl:ruleRemoveTargetById=920273;ARGS:json.statuses,\
    ctl:ruleRemoveTargetById=932240;ARGS:json.statuses,\
    ctl:ruleRemoveTargetById=942260;ARGS:json.statuses,\
    ctl:ruleRemoveTargetById=942431;ARGS:json.statuses,\
    ctl:ruleRemoveTargetById=942432;ARGS:json.statuses,\
    ctl:ruleRemoveTargetById=920273;ARGS:statuses,\
    ctl:ruleRemoveTargetById=932240;ARGS:statuses,\
    ctl:ruleRemoveTargetById=942260;ARGS:statuses,\
    ctl:ruleRemoveTargetById=942431;ARGS:statuses,\
    ctl:ruleRemoveTargetById=942432;ARGS:statuses,\
    ctl:ruleRemoveTargetById=920273;REQUEST_BODY"
SecRule REQUEST_FILENAME "@rx /(?:index\.php/apps/news/api/v[0-9.-]+|apps/news)/feeds$" \
    "id:9508840,\
    phase:1,\
    pass,\
    t:none,\
    nolog,\
    ver:'nextcloud-rule-exclusions-plugin/1.5.0',\
    ctl:ruleRemoveTargetById=920230;ARGS:json.url,\
    ctl:ruleRemoveTargetById=920272;ARGS:json.url,\
    ctl:ruleRemoveTargetById=920273;ARGS:json.url,\
    ctl:ruleRemoveTargetById=931130;ARGS:json.url,\
    ctl:ruleRemoveTargetById=932200;ARGS:json.url,\
    ctl:ruleRemoveTargetById=932380;ARGS:json.url,\
    ctl:ruleRemoveTargetById=942430;ARGS:json.url,\
    ctl:ruleRemoveTargetById=942431;ARGS:json.url,\
    ctl:ruleRemoveTargetById=942432;ARGS:json.url,\
    ctl:ruleRemoveTargetById=920230;ARGS:url,\
    ctl:ruleRemoveTargetById=920272;ARGS:url,\
    ctl:ruleRemoveTargetById=920273;ARGS:url,\
    ctl:ruleRemoveTargetById=931130;ARGS:url,\
    ctl:ruleRemoveTargetById=932200;ARGS:url,\
    ctl:ruleRemoveTargetById=932380;ARGS:url,\
    ctl:ruleRemoveTargetById=942430;ARGS:url,\
    ctl:ruleRemoveTargetById=942431;ARGS:url,\
    ctl:ruleRemoveTargetById=942432;ARGS:url,\
    ctl:ruleRemoveTargetById=920273;REQUEST_BODY,\
    ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:json.password,\
    ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:password"
SecRule REQUEST_FILENAME "@rx /ocs/v[0-9.]+\.php/references/resolve(?:Public)?$" \
    "id:9508880,\
    phase:1,\
    pass,\
    t:none,\
    nolog,\
    ver:'nextcloud-rule-exclusions-plugin/1.5.0',\
    ctl:ruleRemoveTargetById=920230;ARGS:reference,\
    ctl:ruleRemoveTargetById=920272;ARGS:reference,\
    ctl:ruleRemoveTargetById=920273;ARGS:reference,\
    ctl:ruleRemoveTargetById=931130;ARGS:reference,\
    ctl:ruleRemoveTargetById=932200;ARGS:reference,\
    ctl:ruleRemoveTargetById=942430;ARGS:reference,\
    ctl:ruleRemoveTargetById=942431;ARGS:reference,\
    ctl:ruleRemoveTargetById=942432;ARGS:reference,\
    ctl:ruleRemoveTargetById=921151;ARGS_GET:reference,\
    ctl:ruleRemoveTargetById=920272;REQUEST_URI,\
    ctl:ruleRemoveTargetById=920272;REQUEST_URI_RAW"
SecRule REQUEST_FILENAME "@rx /index\.php/apps/notes/api/v[0-9.]+/notes(?:/[0-9]+)?$" \
    "id:9508910,\
    phase:1,\
    pass,\
    t:none,\
    nolog,\
    ver:'nextcloud-rule-exclusions-plugin/1.5.0',\
    ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:content,\
    ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:title,\
    ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:json.content,\
    ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:json.title"
SecRule REQUEST_FILENAME "@rx /apps/notes/notes(?:/[0-9]+(?:/autotitle)?)?$" \
    "id:9508920,\
    phase:1,\
    pass,\
    t:none,\
    nolog,\
    ver:'nextcloud-rule-exclusions-plugin/1.5.0',\
    ctl:ruleRemoveTargetById=920272;REQUEST_BODY,\
    ctl:ruleRemoveTargetById=920273;REQUEST_BODY,\
    ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:content,\
    ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:title,\
    ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:json.content,\
    ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:json.title"
SecRule REQUEST_FILENAME "@rx /ocs/v[0-9.]+\.php/apps/provisioning_api/api/v[0-9.]+/config/apps/theming_customcss/customcss$" \
    "id:9508930,\
    phase:1,\
    pass,\
    t:none,\
    nolog,\
    ver:'nextcloud-rule-exclusions-plugin/1.5.0',\
    ctl:ruleRemoveTargetById=920272;REQUEST_BODY,\
    ctl:ruleRemoveTargetById=920273;REQUEST_BODY,\
    ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:value"
SecRule REQUEST_FILENAME "@rx /ocs/v[0-9.]+\.php/apps/circles/circles/[^/]+/setting$" \
    "id:9508941,\
    phase:1,\
    pass,\
    t:none,\
    nolog,\
    ver:'nextcloud-rule-exclusions-plugin/1.5.0',\
    ctl:ruleRemoveTargetById=920273;REQUEST_BODY,\
    ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:value,\
    ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:json.value"
SecRule REQUEST_FILENAME "@rx /apps/photos/api/v[0-9.]+/preview/[0-9]+$" \
    "id:9508951,\
    phase:3,\
    pass,\
    t:none,\
    nolog,\
    ver:'nextcloud-rule-exclusions-plugin/1.5.0',\
    chain"
    SecRule RESPONSE_STATUS "@streq 500" \
        "t:none,\
        ctl:ruleRemoveById=950100"
SecRule REQUEST_FILENAME "@rx /remote\.php/dav/photos/[^/]+/(?:albums|sharedalbums|places)(?:/[^/]+)?/?$" \
    "id:9508952,\
    phase:1,\
    pass,\
    t:none,\
    nolog,\
    ver:'nextcloud-rule-exclusions-plugin/1.5.0',\
    ctl:ruleRemoveTargetById=920272;REQUEST_BODY,\
    ctl:ruleRemoveTargetById=920273;REQUEST_BODY,\
    ctl:ruleRemoveTargetById=921110;REQUEST_BODY,\
    ctl:ruleRemoveTargetById=932240;XML,\
    ctl:ruleRemoveTargetById=942200;XML,\
    ctl:ruleRemoveTargetById=942340;XML,\
    ctl:ruleRemoveTargetById=942370;XML,\
    ctl:ruleRemoveTargetById=942430;XML,\
    ctl:ruleRemoveTargetById=942431;XML,\
    ctl:ruleRemoveTargetById=942432;XML,\
    ctl:ruleRemoveTargetById=942490;XML,\
    ctl:ruleRemoveTargetById=932240;XML:/*,\
    ctl:ruleRemoveTargetById=942200;XML:/*,\
    ctl:ruleRemoveTargetById=942340;XML:/*,\
    ctl:ruleRemoveTargetById=942370;XML:/*,\
    ctl:ruleRemoveTargetById=942430;XML:/*,\
    ctl:ruleRemoveTargetById=942431;XML:/*,\
    ctl:ruleRemoveTargetById=942432;XML:/*,\
    ctl:ruleRemoveTargetById=942490;XML:/*"
SecRule REQUEST_FILENAME "@rx /remote\.php/dav/recognize/[^/]+/faces/(?:[^/]+/)?$" \
    "id:9508953,\
    phase:1,\
    pass,\
    t:none,\
    nolog,\
    ver:'nextcloud-rule-exclusions-plugin/1.5.0',\
    ctl:ruleRemoveTargetById=921110;REQUEST_BODY"
SecRule REQUEST_FILENAME "@rx /apps/photos/api/v[0-9.]+/config/(?:photosLocation|photosSourceFolders)$" \
    "id:9508957,\
    phase:1,\
    pass,\
    t:none,\
    nolog,\
    ver:'nextcloud-rule-exclusions-plugin/1.5.0',\
    ctl:ruleRemoveTargetById=920273;ARGS:json.value,\
    ctl:ruleRemoveTargetById=942100;ARGS:json.value,\
    ctl:ruleRemoveTargetById=942200;ARGS:json.value,\
    ctl:ruleRemoveTargetById=942370;ARGS:json.value,\
    ctl:ruleRemoveTargetById=942520;ARGS:json.value,\
    ctl:ruleRemoveTargetById=942431;ARGS:json.value,\
    ctl:ruleRemoveTargetById=942432;ARGS:json.value,\
    ctl:ruleRemoveTargetById=942460;ARGS:json.value,\
    ctl:ruleRemoveTargetById=920273;ARGS:value,\
    ctl:ruleRemoveTargetById=942100;ARGS:value,\
    ctl:ruleRemoveTargetById=942200;ARGS:value,\
    ctl:ruleRemoveTargetById=942370;ARGS:value,\
    ctl:ruleRemoveTargetById=942431;ARGS:value,\
    ctl:ruleRemoveTargetById=942432;ARGS:value,\
    ctl:ruleRemoveTargetById=942460;ARGS:value,\
    ctl:ruleRemoveTargetById=942520;ARGS:value,\
    ctl:ruleRemoveTargetById=920273;REQUEST_BODY"
SecRule REQUEST_FILENAME "@rx /apps/mail/api/autoconfig/(?:ispdb|mx)/(?:[^/]+/)?[^/]+\.(?:com|inc)$" \
    "id:9508970,\
    phase:1,\
    pass,\
    t:none,\
    nolog,\
    ver:'nextcloud-rule-exclusions-plugin/1.5.0',\
    ctl:ruleRemoveById=920440"
SecRule REQUEST_FILENAME "@rx /apps/mail/api/avatars/(?:url|image)/[^/]+\.(?:com|inc)$" \
    "id:9508971,\
    phase:1,\
    pass,\
    t:none,\
    nolog,\
    ver:'nextcloud-rule-exclusions-plugin/1.5.0',\
    ctl:ruleRemoveById=920440"
SecRule REQUEST_FILENAME "@rx /apps/mail/api/accounts(?:/[0-9]+)?$" \
    "id:9508972,\
    phase:1,\
    pass,\
    t:none,\
    nolog,\
    ver:'nextcloud-rule-exclusions-plugin/1.5.0',\
    ctl:ruleRemoveTargetById=920273;ARGS:emailAddress,\
    ctl:ruleRemoveTargetById=920273;ARGS:imapUser,\
    ctl:ruleRemoveTargetById=920273;ARGS:smtpUser,\
    ctl:ruleRemoveTargetById=920273;ARGS:json.emailAddress,\
    ctl:ruleRemoveTargetById=920273;ARGS:json.imapUser,\
    ctl:ruleRemoveTargetById=920273;ARGS:json.smtpUser,\
    ctl:ruleRemoveTargetById=920273;REQUEST_BODY,\
    ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:imapPassword,\
    ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:smtpPassword,\
    ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:json.imapPassword,\
    ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:json.smtpPassword"
SecRule REQUEST_FILENAME "@endsWith /apps/mail/proxy" \
    "id:9508973,\
    phase:1,\
    pass,\
    t:none,\
    nolog,\
    ver:'nextcloud-rule-exclusions-plugin/1.5.0',\
    ctl:ruleRemoveTargetById=920230;ARGS:src,\
    ctl:ruleRemoveTargetById=920273;ARGS:src,\
    ctl:ruleRemoveTargetById=931130;ARGS:src,\
    ctl:ruleRemoveTargetById=932235;ARGS:src,\
    ctl:ruleRemoveTargetById=932236;ARGS:src,\
    ctl:ruleRemoveTargetById=932200;ARGS:src,\
    ctl:ruleRemoveTargetById=942120;ARGS:src,\
    ctl:ruleRemoveTargetById=942421;ARGS:src,\
    ctl:ruleRemoveTargetById=942430;ARGS:src,\
    ctl:ruleRemoveTargetById=942431;ARGS:src,\
    ctl:ruleRemoveTargetById=942432;ARGS:src"
SecRule REQUEST_FILENAME "@endsWith /apps/mail/api/messages" \
    "id:9508974,\
    phase:1,\
    pass,\
    t:none,\
    nolog,\
    ver:'nextcloud-rule-exclusions-plugin/1.5.0',\
    ctl:ruleRemoveTargetById=920230;ARGS:filter,\
    ctl:ruleRemoveTargetById=920273;ARGS:filter,\
    ctl:ruleRemoveTargetById=942431;ARGS:filter,\
    ctl:ruleRemoveTargetById=942432;ARGS:filter,\
    ctl:ruleRemoveTargetById=920272;REQUEST_URI,\
    ctl:ruleRemoveTargetById=920272;REQUEST_URI_RAW"
SecRule REQUEST_FILENAME "@rx /apps/mail/api/textBlocks(?:/[0-9]+)?$" \
    "id:9508975,\
    phase:1,\
    pass,\
    t:none,\
    nolog,\
    ver:'nextcloud-rule-exclusions-plugin/1.5.0',\
    ctl:ruleRemoveTargetById=920273;REQUEST_BODY,\
    ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:content,\
    ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:json.content"
SecRule REQUEST_FILENAME "@rx /apps/mail/api/messages/[0-9]+/flags$" \
    "id:9508978,\
    phase:1,\
    pass,\
    t:none,\
    nolog,\
    ver:'nextcloud-rule-exclusions-plugin/1.5.0',\
    ctl:ruleRemoveTargetById=920273;ARGS_NAMES:flags.$notjunk,\
    ctl:ruleRemoveTargetById=942290;ARGS_NAMES:flags.$notjunk,\
    ctl:ruleRemoveTargetById=920273;ARGS_NAMES:json.flags.$notjunk,\
    ctl:ruleRemoveTargetById=942290;ARGS_NAMES:json.flags.$notjunk,\
    ctl:ruleRemoveTargetById=920273;REQUEST_BODY"
SecRule REQUEST_FILENAME "@rx /apps/mail/api/contactIntegration/match/[^/]+\.(?:com|inc)$" \
    "id:9508979,\
    phase:1,\
    pass,\
    t:none,\
    nolog,\
    ver:'nextcloud-rule-exclusions-plugin/1.5.0',\
    ctl:ruleRemoveById=920440"
SecRule REQUEST_FILENAME "@rx /apps/mail/api/preferences/(?:account-settings|reply-mode)$" \
    "id:9508981,\
    phase:1,\
    pass,\
    t:none,\
    nolog,\
    ver:'nextcloud-rule-exclusions-plugin/1.5.0',\
    ctl:ruleRemoveTargetById=920273;ARGS:value,\
    ctl:ruleRemoveTargetById=932236;ARGS:value,\
    ctl:ruleRemoveTargetById=932240;ARGS:value,\
    ctl:ruleRemoveTargetById=942200;ARGS:value,\
    ctl:ruleRemoveTargetById=942260;ARGS:value,\
    ctl:ruleRemoveTargetById=942430;ARGS:value,\
    ctl:ruleRemoveTargetById=942431;ARGS:value,\
    ctl:ruleRemoveTargetById=942432;ARGS:value,\
    ctl:ruleRemoveTargetById=942460;ARGS:value,\
    ctl:ruleRemoveTargetById=942490;ARGS:value,\
    ctl:ruleRemoveTargetById=920273;ARGS:json.value,\
    ctl:ruleRemoveTargetById=932236;ARGS:json.value,\
    ctl:ruleRemoveTargetById=932240;ARGS:json.value,\
    ctl:ruleRemoveTargetById=942200;ARGS:json.value,\
    ctl:ruleRemoveTargetById=942260;ARGS:json.value,\
    ctl:ruleRemoveTargetById=942430;ARGS:json.value,\
    ctl:ruleRemoveTargetById=942431;ARGS:json.value,\
    ctl:ruleRemoveTargetById=942432;ARGS:json.value,\
    ctl:ruleRemoveTargetById=942460;ARGS:json.value,\
    ctl:ruleRemoveTargetById=942490;ARGS:json.value,\
    ctl:ruleRemoveTargetById=920273;REQUEST_BODY"
SecRule REQUEST_FILENAME "@rx /apps/mail/api/settings/provisioning(?:/[0-9]+)?$" \
    "id:9508982,\
    phase:1,\
    pass,\
    t:none,\
    nolog,\
    ver:'nextcloud-rule-exclusions-plugin/1.5.0',\
    ctl:ruleRemoveTargetById=920230;ARGS:data.sieveUser,\
    ctl:ruleRemoveTargetById=920272;ARGS:data.sieveUser,\
    ctl:ruleRemoveTargetById=920273;ARGS:data.sieveUser,\
    ctl:ruleRemoveTargetById=942432;ARGS:data.sieveUser,\
    ctl:ruleRemoveTargetById=920230;ARGS:data.imapUser,\
    ctl:ruleRemoveTargetById=920272;ARGS:data.imapUser,\
    ctl:ruleRemoveTargetById=920273;ARGS:data.imapUser,\
    ctl:ruleRemoveTargetById=942432;ARGS:data.imapUser,\
    ctl:ruleRemoveTargetById=920230;ARGS:data.smtpUser,\
    ctl:ruleRemoveTargetById=920272;ARGS:data.smtpUser,\
    ctl:ruleRemoveTargetById=920273;ARGS:data.smtpUser,\
    ctl:ruleRemoveTargetById=942432;ARGS:data.smtpUser,\
    ctl:ruleRemoveTargetById=920230;ARGS:data.emailTemplate,\
    ctl:ruleRemoveTargetById=920272;ARGS:data.emailTemplate,\
    ctl:ruleRemoveTargetById=920273;ARGS:data.emailTemplate,\
    ctl:ruleRemoveTargetById=942432;ARGS:data.emailTemplate,\
    ctl:ruleRemoveTargetById=920230;ARGS:json.data.sieveUser,\
    ctl:ruleRemoveTargetById=920272;ARGS:json.data.sieveUser,\
    ctl:ruleRemoveTargetById=920273;ARGS:json.data.sieveUser,\
    ctl:ruleRemoveTargetById=942432;ARGS:json.data.sieveUser,\
    ctl:ruleRemoveTargetById=920230;ARGS:json.data.imapUser,\
    ctl:ruleRemoveTargetById=920272;ARGS:json.data.imapUser,\
    ctl:ruleRemoveTargetById=920273;ARGS:json.data.imapUser,\
    ctl:ruleRemoveTargetById=942432;ARGS:json.data.imapUser,\
    ctl:ruleRemoveTargetById=920230;ARGS:json.data.smtpUser,\
    ctl:ruleRemoveTargetById=920272;ARGS:json.data.smtpUser,\
    ctl:ruleRemoveTargetById=920273;ARGS:json.data.smtpUser,\
    ctl:ruleRemoveTargetById=942432;ARGS:json.data.smtpUser,\
    ctl:ruleRemoveTargetById=920230;ARGS:json.data.emailTemplate,\
    ctl:ruleRemoveTargetById=920272;ARGS:json.data.emailTemplate,\
    ctl:ruleRemoveTargetById=920273;ARGS:json.data.emailTemplate,\
    ctl:ruleRemoveTargetById=942432;ARGS:json.data.emailTemplate,\
    ctl:ruleRemoveTargetById=920272;REQUEST_BODY,\
    ctl:ruleRemoveTargetById=920273;REQUEST_BODY"
SecRule REQUEST_FILENAME "@rx /apps/mail/api/sieve/account/[0-9]+$" \
    "id:9508986,\
    phase:1,\
    pass,\
    t:none,\
    nolog,\
    ver:'nextcloud-rule-exclusions-plugin/1.5.0',\
    ctl:ruleRemoveTargetById=920273;REQUEST_BODY,\
    ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:sievePassword,\
    ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:json.sievePassword"
SecRule REQUEST_FILENAME "@rx /apps/mail/api/(?:internalAddress|trustedsenders)/[^/]+\.(?:com|inc)$" \
    "id:9508988,\
    phase:1,\
    pass,\
    t:none,\
    nolog,\
    ver:'nextcloud-rule-exclusions-plugin/1.5.0',\
    ctl:ruleRemoveById=920440"
SecRule REQUEST_FILENAME "@rx /apps/mail/api/accounts/[0-9]+(?:/aliases/[0-9]+)?/signature$" \
    "id:9508989,\
    phase:1,\
    pass,\
    t:none,\
    nolog,\
    ver:'nextcloud-rule-exclusions-plugin/1.5.0',\
    ctl:ruleRemoveTargetById=920273;REQUEST_BODY,\
    ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:json.signature,\
    ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:signature"
SecRule REQUEST_FILENAME "@rx /apps/mail/api/(?:drafts(?:/[0-9]+|/\{id\})?|outbox(?:/from-draft)?(?:/[0-9]+)?|accounts/[0-9]+/draft)?$" \
    "id:9508991,\
    phase:1,\
    pass,\
    t:none,\
    nolog,\
    ver:'nextcloud-rule-exclusions-plugin/1.5.0',\
    ctl:ruleRemoveTargetById=920273;ARGS,\
    ctl:ruleRemoveTargetById=932236;ARGS,\
    ctl:ruleRemoveTargetById=942430;ARGS,\
    ctl:ruleRemoveTargetById=942431;ARGS,\
    ctl:ruleRemoveTargetById=942432;ARGS,\
    ctl:ruleRemoveTargetById=932236;ARGS_NAMES:cc,\
    ctl:ruleRemoveTargetById=920272;REQUEST_BODY,\
    ctl:ruleRemoveTargetById=920273;REQUEST_BODY,\
    ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:body,\
    ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:bodyHtml,\
    ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:bodyPlain,\
    ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:body.value,\
    ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:data.body.value,\
    ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:data.editorBody,\
    ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:data.subject,\
    ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:editorBody,\
    ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:json.body,\
    ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:json.bodyHtml,\
    ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:json.bodyPlain,\
    ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:json.body.value,\
    ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:json.data.body.value,\
    ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:json.data.editorBody,\
    ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:json.data.subject,\
    ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:json.editorBody,\
    ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:json.subject,\
    ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:subject"
